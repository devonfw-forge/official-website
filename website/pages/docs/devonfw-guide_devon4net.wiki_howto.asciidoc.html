<!DOCTYPE html><html lang="en"><head><style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote::before{display:none}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{word-spacing:0;line-height:1.6}
.quoteblock.abstract blockquote::before,.quoteblock.abstract p::before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style><style>.toc-current{font-weight: bold;} .toc-root{font-family: "Open Sans","DejaVu Sans",sans-serif;
                       font-size: 0.9em;} #content{display: flex; flex-direction: column; flex: 1 1 auto;}
             .nav-footer{text-align: center; margin-top: auto;}
             .nav-footer > p > a {white-space: nowrap;}</style>
<meta http-equiv="Content-Type" content="text/html; charset=">
<meta name="generator" content="Asciidoctor 1.5.8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="Updated at 2022-09-09 09:15:36 UTC">

<!-- ******** SOCIAL MEDIA META ********** -->

<meta name="title" property="og:title" content="devonfw website">
<meta property="og:type" content="website">
<meta name="image" property="og:image" content="https://devonfw.com/images/devonfwwebsite.png">
<meta name="description" property="og:description" content="devonfw is the standard open source software development platform; Serving the full Software Delivery Life Cycle.">
<meta property="og:url" content="https://devonfw.com/index.html">

<meta name="twitter:title" content="devonfw website">
<meta name="twitter:description" content="devonfw is the standard open source software development platform; Serving the full Software Delivery Life Cycle.">
<meta name="twitter:image" content="https://devonfw.com/images/devonfwwebsite.png">
<meta name="twitter:card" content="summary_large_image">

<!-- ************************************* -->


<title>devonfw guide</title>
<!-- devonfw website stylesheet -->
<link rel="stylesheet" type="text/css" href="/devonfw.css">
<!-- Lunr -->
<script src="/website/assets/scripts/lunr.min.js"></script>
<!-- JQuery -->
<script src="/website/assets/scripts/jquery.min.js"></script>
<link rel="stylesheet" href="/website/assets/styles/font-awesome.min.css">
<link rel="stylesheet" href="/website/assets/styles/googlecode.min.css">
<script src="/website/assets/scripts/highlight.min.js"></script>
<script src="/website/assets/scripts/common.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
<link rel="stylesheet" href="/website/assets/styles/bootstrap.min.css">

<script src="/website/assets/scripts/anchor.min.js"></script>

<script src="/website/components/header/search-engine/bundle.js"></script>

<script src="/website/shared/rightmenu.js"></script>

<!-- ************** Google analytics ************ -->
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

gtag('consent', 'default', {
  'analytics_storage': 'denied'
});
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-151636804-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-151636804-1');
</script>
<script>
  function consentGranted() {
    gtag('consent', 'update', {
      'analytics_storage': 'granted'
    });
  }
</script>

<!-- ******************************************** -->


</head>
<body id="devonfw-guide_master.asciidoc" class="book toc2 toc-left">
<div id="website-navbar" class="website-navbar">
<button id="menu-button" class="menu-button">
  <img src="/images/menu-button.svg" width="32px" height="32px" alt="">
</button>

<ul>
<li>
<p><span class="image"><a class="image" href="/website/pages/welcome/welcome.html"><img alt="logo" src="/images/Logo_devonfw.svg"></a></span></p>
</li>
<li>
<p><a href="https://devonfw.com/website/pages/learning/">Tutorials</a></p>
</li>
<li>
<p><a href="/website/pages/solutions/index.html">Solutions</a></p>
</li>
<li>
<p><a href="/website/pages/docs/master.html" class="active">Docs</a></p>
</li>
</ul>

<form class="form-inline">
  <div class="search-bar">
    <input id="search-field" type="search" class="form-control mr-sm-2" placeholder="Search by keyword(s)..." aria-label="Search" style="height: auto;" autocomplete="off">
    <div class="sb-res-pos px-4">
      <div id="click-outside" class="click-outside z-50 hidden"></div>
      <div class="col rounded px-0 border z-100 bg-white hidden search-bar-results" id="search-results-box">
      </div>
    </div>
  </div>
</form>
<a class="navbar-github text-white" href="https://github.com/devonfw/">
  <img src="/images/github-mark.png" width="auto" height="auto" alt="">
</a></div>
<div id="sidebar" class="wiki-sidebar"></div>

<div id="header">
<h1>devonfw guide</h1>
<div class="details">
<span id="author" class="author">Updated at 2022-09-09 09:23:16 UTC</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<p><span class="toc-root"><a href="master.html">devonfw guide</a></span></p><ul class="sectlevel0">
<li><a href="devonfw-guide_getting-started.wiki_getting-started.asciidoc.html">Getting Started</a>
</li>
<li><a href="devonfw-guide_ide.wiki_devonfw-ide.asciidoc.html">devonfw-ide</a>
</li>
<li><a href="devonfw-guide_devon4j.wiki_devon4j.asciidoc.html">Java</a>
</li>
<li><a href="devonfw-guide_devon4ts.wiki_h8458dc0b0ef89f9cdf46ef82c02cf0cd.asciidoc.html">devon4ts</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_master-devon4net.asciidoc.html">.net</a>
<ul class="sectlevel1">
<li><a href="devonfw-guide_devon4net.wiki_master-devon4net.asciidoc_architecture-basics.html">Architecture basics</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_master-devon4net.asciidoc_user-guide.html">User guide</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_master-devon4net.asciidoc_how-to-section.html">How To section</a>
<ul class="sectlevel2">
<li><a href="devonfw-guide_devon4net.wiki_howto.asciidoc.html"><span class="toc-current">How to use devon4net</span></a>
<ul class="sectlevel3">
<li><a href="devonfw-guide_devon4net.wiki_howto.asciidoc.html#devonfw-guide_devon4net.wiki_howto.asciidoc_introduction">Introduction</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_howto.asciidoc.html#devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-create-a-new-devon4net-project">How to: Create a new devon4net project</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_howto.asciidoc.html#devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-create-and-add-certificates-to-a-project">How to: Create and add certificates to a project</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_howto.asciidoc.html#devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-setup-jwt">How to: Setup JWT</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_howto.asciidoc.html#devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-setup-security-and-roles-in-api-controllers">How to: Setup security and roles in API controllers</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_howto.asciidoc.html#devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-avoid-cross-site-request-forgery-xsrf-or-csrf-attacks">How to: Avoid cross-site request forgery (XSRF or CSRF) attacks</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_howto.asciidoc.html#devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-import-a-database">How to: Import a database</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_howto.asciidoc.html#devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-use-litedb">How to: Use LiteDb</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_howto.asciidoc.html#devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-customize-headers">How to: Customize Headers</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_howto.asciidoc.html#devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-specflow">How to: Specflow</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_howto.asciidoc.html#devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-circuit-breaker-communication-with-certificates">How To: Circuit breaker communication with Certificates</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_howto.asciidoc.html#devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-rabbitmq">How to: RabbitMQ</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_howto.asciidoc.html#devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-kafka">How to: Kafka</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_howto.asciidoc.html#devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-protocol-buffers">How to: Protocol buffers</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_howto.asciidoc.html#devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-aws-lambda-function">How to: AWS Lambda Function</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_howto.asciidoc.html#devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-aws-serverless">How to: AWS Serverless</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="devonfw-guide_devon4net.wiki_master-devon4net.asciidoc_cobigen-guide.html">Cobigen guide</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_master-devon4net.asciidoc_coding-conventions.html">Coding conventions</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_master-devon4net.asciidoc_environment.html">Environment</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_master-devon4net.asciidoc_packages.html">Packages</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_master-devon4net.asciidoc_templates.html">Templates</a>
</li>
<li><a href="devonfw-guide_devon4net.wiki_master-devon4net.asciidoc_samples.html">Samples</a>
</li>
</ul>
</li>
<li><a href="devonfw-guide_general_db_master-database.asciidoc.html">Choosing your Database</a>
</li>
<li><a href="devonfw-guide_devonfw-guide_master.asciidoc_2.html">Tools</a>
</li>
<li><a href="devonfw-guide_devonfw-guide_master.asciidoc_3.html">Architecture</a>
</li>
<li><a href="devonfw-guide_devonfw-guide_master.asciidoc_4.html">CI/CD</a>
</li>
<li><a href="devonfw-guide_general_master-contributing.asciidoc.html">Contributing</a>
</li>
<li><a href="devonfw-guide_general_master-release-notes.asciidoc.html">Release Notes</a>
</li>
</ul>
</div>
</div><div id="content">
<div class="sect2">
<h3 id="devonfw-guide_devon4net.wiki_howto.asciidoc">How to use devon4net</h3>
<!-- toc disabled -->
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_howto.asciidoc_introduction">Introduction</h4>
<div class="paragraph">
<p>As you may know, <a href="https://devonfw.com/website/pages/docs/devonfw-guide_devon4net.wiki_master-devon4net.asciidoc.html">devon4net</a> is a framework that will assist you in getting started on your.NET applications and integrating high end configurable components.</p>
</div>
<div class="paragraph">
<p>This article contains information in the form of a step-by-step guide on how to do a variety of operations.</p>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-create-a-new-devon4net-project">How to: Create a new devon4net project</h4>
<div class="paragraph">
<p>In this part, you will learn you how to easily create a new project using devon4net libraries and start working on it. You can create a variety of applications thanks to the different templates available. There are also multiple ways to create a new project, we will show you the most common ways.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The configuration characteristics are not covered in this document. Please feel free to read the documentation for each component to discover how they work and the configuration options available.
</td>
</tr>
</tbody></table>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_command-line-interface-cli">Command Line Interface (CLI)</h5>
<div class="paragraph">
<p>This is the fastest and most efficient way. You will be installing and starting a project thanks to the template available in the NuGet Gallery using CLI. For this part you will need to have .NET 6.0 SDK installed. You can run the following command to check your version:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">&gt; dotnet --version
6.0.102</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you don’t get any response please follow the <a href="https://docs.microsoft.com/en-us/dotnet/core/install/">installation guide</a> provided by Microsoft to install the latest version of .Net SDK for your OS.</p>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_howto.asciidoc_step-1---install-the-template">Step 1 - Install the Template</h6>
<div class="paragraph">
<p>Open your favourite terminal (Windows/Linux/macOS) and run the command showed below to install the latest version of the the <a href="https://www.nuget.org/packages/Devon4Net.WebAPI.Template/">devon4net web API template</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">&gt; dotnet new --install Devon4Net.WebAPI.Template
The following template packages will be installed:
   Devon4Net.WebApI.Template

Success: Devon4Net.WebAPI.Template::6.0.3 installed the following templates:
Template Name                    Short Name    Language  Tags
-------------------------------  ------------  --------  ------------------------------
Devon4Net API solution template  Devon4NetAPI  [C#]      devonfw/Devon4Net/Devon4NetAPI</code></pre>
</div>
</div>
<div class="paragraph">
<p>We recommend you updating the template to the latest version. However, using the following option, you can select the version of your interest:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">&gt; dotnet new --install Devon4Net.WebAPI.Template::6.0.3</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you will have the template available in your Visual Studio 2022. Just type <code>devon4net</code> in the search bar when creating a new project!</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/api_template_ide.png" alt="api template ide">
</div>
<div class="title">Figure 17. Devon4Net API template in VS2022</div>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_howto.asciidoc_step-2---create-a-new-project">Step 2 - Create a new project</h6>
<div class="paragraph">
<p>To create a new project run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">&gt; dotnet new Devon4NetAPI
The template "Devon4Net API solution template" was created successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will create a project with the default name in the actual directory. If you want to specify the desired name and output directory you can specify the following options:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">&gt; dotnet new Devon4NetAPI --name MyProject --output C:\Projects\MyProject
The template "Devon4Net API solution template" was created successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can do it also choosing the template when creating a new project in Visual Studio 2022 as shown in figure 1, and configuring the name and output directory as shown in figure 2.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/api_template_configure.png" alt="api template configure">
</div>
<div class="title">Figure 18. Devon4Net API template in VS2022</div>
</div>
</div>
<div class="sect5">
<h6 id="asciidoc_devonfw-guide_devon4net.wiki_howto.asciidoc_step-3---run-it">Step 3 - Run it</h6>
<div class="paragraph">
<p>After running it with Kestrel you will be able to access to the swagger <code>index.html</code> and try the API in the following xref:devonfw-guide/devon4net.wiki_ <a href="https://localhost.8085/swagger/index.html">https://localhost.8085/swagger/index.html</a></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_create-it-from-scratch-in-visual-studio-2022">Create it from scratch in Visual Studio 2022</h5>
<div class="paragraph">
<p>This method is a little more time consuming, but it allows for a more customized configuration and project structure. You will be using Visual Studio 2022 to create the project and add everything you need by hand.</p>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_howto.asciidoc_step-1---create-a-new-project">Step 1 - Create a new project</h6>
<div class="paragraph">
<p>Create a new ASP.NET Core Web API project using the template provided by Visual Studio. You can type <code>api</code> in the search bar and select it as shown in figure 3.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/api_template_create_project.png" alt="api template create project">
</div>
<div class="title">Figure 19. ASP.NET Core Web API template in VS2022</div>
</div>
<div class="paragraph">
<p>Once you go through all the initial configuration process, choosing a name, location and so on; you will find your project as shown in the next image.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images\api_template_initial_structure.png" alt="images\api template initial structure">
</div>
<div class="title">Figure 20. Default ASP.NET Core Web API template structure</div>
</div>
<div class="paragraph">
<p>You can delete both <code>WeatherForecastController.cs</code> and <code>WeatherForecast.cs</code> as they are an example in the template but we recommend you keeping them so you can try the API when done with all the steps.</p>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_howto.asciidoc_step-2---add-the-nuget-reference">Step 2 - Add the NuGet reference</h6>
<div class="paragraph">
<p>To install the NuGet package for the API Configuration we will use the Visual Studio package manager console. To open it, go to <code>View &gt; Other Windows &gt; Package Manager Console</code> as shown in the figure below.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images\api_template_package_manager.png" alt="images\api template package manager">
</div>
<div class="title">Figure 21. Package Manager Console location in menu</div>
</div>
<div class="paragraph">
<p>Now you can run the following command. It will take a minute to download and install all the packages:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">PM&gt; install-package Devon4Net.Infrastructure.WebAPI</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once its done, you should be able to see the dependency in the Package Dependencies of the project.</p>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_howto.asciidoc_step-3---set-up-your-project">Step 3 - Set up your project</h6>
<div class="paragraph">
<p>Now you will need to add some configuration in the <code>Program.cs</code>. The following lines will initialize the configuration for the WebHostBuilder and configure the components that were imported with the NuGet installation respectively, making use of extensions methods for the <code>ServiceCollection</code> and <code>WebHostBuilder</code> classes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">builder.WebHost.InitializeDevonFw();
builder.Services.ConfigureDevonFw(builder.Configuration);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you’ll need to configure the middlewares included with the following line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">app.SetupMiddleware(builder.Services);</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Don’t forget to import the package to be able to use this methods!
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>It is not necessary, but we recommend to also setup the logger so you can keep track of the trace running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">builder.Services.SetupLog(builder.Configuration);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Program.cs</code> will end up looking like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">using Devon4Net.Application.WebAPI.Configuration;
using Devon4Net.Application.WebAPI.Configuration.Application;
using Devon4Net.Infrastructure.Middleware.Middleware;

var builder = WebApplication.CreateBuilder(args);

builder.Services.AddControllers();

// devon4net
builder.WebHost.InitializeDevonFw();
builder.Services.SetupLog(builder.Configuration);
builder.Services.SetupDevonfw(builder.Configuration);

var app = builder.Build();
app.UseHttpsRedirection();

// devon4net
app.SetupMiddleware(builder.Services);

app.UseAuthorization();

app.MapControllers();

app.Run();</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_howto.asciidoc_step-4---configure-components">Step 4 - Configure components</h6>
<div class="paragraph">
<p>The lines added on the previous step will need some configuration in the <code>appsettings.json</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "devonfw": {
    "UseDetailedErrorsKey": true,
    "UseIIS": false,
    "UseSwagger": true,
    "UseXsrf": true,
    "UseModelStateValidation": true,
    "Environment": "Development",
    "ForceUseHttpsRedirection": false,
    "Kestrel": {
      "UseHttps": true,
      "HttpProtocol": "Http1AndHttp2", //Http1, Http2, Http1AndHttp2, none
      "ApplicationPort": 8085,
      "SslProtocol": "Tls12", //Tls12, Tls13, none. For Https2 Tls12 is needed
      "ExtraSettings": {
        "KeepAliveTimeout": 120, //in seconds
        "MaxConcurrentConnections": 100,
        "MaxConcurrentUpgradedConnections": 100,
        "MaxRequestBodySize": 28.6, //In MB. The default maximum request body size is 30,000,000 bytes, which is approximately 28.6 MB
        "Http2MaxStreamsPerConnection": 100,
        "Http2InitialConnectionWindowSize": 131072, // From 65,535 and less than 2^31 (2,147,483,648)
        "Http2InitialStreamWindowSize": 98304, // From 65,535 and less than 2^31 (2,147,483,648)
        "AllowSynchronousIO": true
      }
    },
    "IIS": {
      "ForwardClientCertificate": true,
      "AutomaticAuthentication": true,
      "AuthenticationDisplayName": ""
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And also in the <code>appsettings.Development.json</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "ExtraSettingsFiles": [
    "appsettingsExtra.json",
    "Directory path",
    "Specific file name"
  ],
  "KillSwitch": {
    "UseKillSwitch": false,
    "EnableRequests": false,
    "HttpStatusCode": 403
  },
  "ConnectionStrings": {
    "Default": "Todos",
    "Employee": "Employee",
    "RabbitMqBackup": "Add your database connection string here for messaging backup",
    "MediatRBackup": "Add your databascere connection string here for messaging backup"
  },
  "Certificates": {
    "ServerCertificate": {
      "Certificate": "",
      "CertificatePassword": ""
    },
    "ClientCertificate": {
      "DisableClientCertificateCheck": true,
      "RequireClientCertificate": false,
      "CheckCertificateRevocation": true,
      "ClientCertificates": {
        "Whitelist": [
          "3A87A49460E8FE0E2A198E63D408DC58435BC501"
        ]
      }
    }
  },
  "Headers": {
    "AccessControlExposeHeader": "Authorization",
    "StrictTransportSecurityHeader": "",
    "XFrameOptionsHeader": "DENY",
    "XssProtectionHeader": "1;mode=block",
    "XContentTypeOptionsHeader": "nosniff",
    "ContentSecurityPolicyHeader": "",
    "PermittedCrossDomainPoliciesHeader": "",
    "ReferrerPolicyHeader": ""
  },
  "Cors": []
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_unable-to-start-devon4net-template-on-macos-or-older-windows-versions">Unable to start devon4net template on macOS or older Windows Versions</h5>
<div class="paragraph">
<p>If you try to execute the devon4net template on macOS or an earlier version of Windows, such as Windows 7, you will receive the following error message:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/Exception-DevonWebAPI-MacEnvironment.png" alt="Exception DevonWebAPI MacEnvironment">
</div>
</div>
<div class="paragraph">
<p>Because these operating systems lack ALPN(Application-Layer Protocol Negotiation) functionality, Kestrel does not handle HTTP/2 with TLS.</p>
</div>
<div class="paragraph">
<p>To resolve this, navigate to 'appsettings.json' and change the Kestrel configuration as seen below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "devonfw": {
    "UseDetailedErrorsKey": true,
    "UseIIS": false,
    "UseSwagger": true,
    "UseXsrf": true,
    "UseModelStateValidation": true,
    "Environment": "Development",
    "ForceUseHttpsRedirection": false,
    "Kestrel": {
      "UseHttps": true,
      "HttpProtocol": "Http1AndHttp2", //Http1, Http2, Http1AndHttp2, none
      "ApplicationPort": 8085,
      "SslProtocol": "none", //Tls12, Tls13, none. For Https2 Tls12 is needed
      "ExtraSettings": {
        "KeepAliveTimeout": 120, //in seconds
        "MaxConcurrentConnections": 100,
        "MaxConcurrentUpgradedConnections": 100,
        "MaxRequestBodySize": 28.6, //In MB. The default maximum request body size is 30,000,000 bytes, which is approximately 28.6 MB
        "Http2MaxStreamsPerConnection": 100,
        "Http2InitialConnectionWindowSize": 131072, // From 65,535 and less than 2^31 (2,147,483,648)
        "Http2InitialStreamWindowSize": 98304, // From 65,535 and less than 2^31 (2,147,483,648)
        "AllowSynchronousIO": true
      }
    },
    "IIS": {
      "ForwardClientCertificate": true,
      "AutomaticAuthentication": true,
      "AuthenticationDisplayName": ""
    }
  }
}</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
HTTP/2 without TLS should only be used during app development. Production apps should always use transport security.
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_howto.asciidoc_references">References</h5>
<div class="paragraph">
<p>Here are some interesting references to continue learning about this topic:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.microsoft.com/en-us/dotnet/core/install/">Install .NET on your OS - Microsoft Docs</a></p>
</li>
<li>
<p><a href="https://docs.microsoft.com/es-es/dotnet/core/tools/">.NET CLI overview - Microsoft Docs</a></p>
</li>
<li>
<p><a href="https://docs.microsoft.com/es-es/dotnet/core/tools/dotnet-new-install">dotnet new --install option - Microsoft Docs</a></p>
</li>
<li>
<p><a href="https://docs.microsoft.com/es-es/dotnet/core/tools/dotnet-new">dotnet new - Microsoft Docs</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-create-and-add-certificates-to-a-project">How to: Create and add certificates to a project</h4>
<div class="paragraph">
<p>In this part, you will learn how to easily create a new certificate and properly add it to your devon4net project.</p>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_create-a-certificate-using-openssl">Create a certificate using OpenSSL</h5>
<div class="paragraph">
<p>In order to create our own certificate for development purposes we will be using <a href="https://github.com/openssl/openssl">OpenSSL</a> toolkit. To ensure correct behavior, make sure the tool is properly installed.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Please refer to the <a href="https://www.openssl.org/docs/man3.0/man1/">OpenSSL command documentation</a> to learn more about the commands used in this guide and how to install the toolkit.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>To run commands for OpenSSL, you will need to add OpenSSL to your environment, variables, or open a OpenSSL command prompt.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The working directory (directory where all files are created and readed) is the console actual path. Use <code>cd</code> command to go to your desired directory.
</td>
</tr>
</tbody></table>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_howto.asciidoc_step-1---create-a-certificate-authority-ca">Step 1 - Create a Certificate Authority (CA)</h6>
<div class="paragraph">
<p>First we will need to create a Certificate Authority to sign the certificate. For that, we will run the following command which will create the certificate <code>RootCA.pem</code> and the corresponding private key <code>RootCA.key</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">&gt; openssl req -x509 -nodes -new -sha256 -days 1024 -newkey rsa:2048 -keyout RootCA.key -out RootCA.pem -subj "/C=ES/ST=Valencia/L=Valencia/O=Certificates/CN=MyProjectCertificate.local"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we will create the public key <code>RootCA.crt</code> for the certificate by running the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">&gt; openssl x509 -outform pem -in RootCA.pem -out RootCA.crt</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to export the certificate you can run the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">&gt; openssl pkcs12 -export -out RootCA.pfx -inkey RootCA.key -in RootCA.crt</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_howto.asciidoc_step-2---create-a-certificate-signed-by-the-ca">Step 2 - Create a Certificate signed by the CA</h6>
<div class="paragraph">
<p>To create a new certificate run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">&gt; openssl req -new -nodes -newkey rsa:2048 -keyout localhost.key -out localhost.csr -subj "/C=ES/ST=Valencia/L=Valencia/O=Certificates/CN=localhost.local"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Before signing it, create a <code>domains.ext</code> that contains the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-txt" data-lang="txt">authorityKeyIdentifier=keyid,issuer
basicConstraints=CA:FALSE
keyUsage = digitalSignature, nonRepudiation, keyEncipherment, dataEncipherment
subjectAltName = @alt_names
[alt_names]
DNS.1 = localhost
DNS.2 = localhost.local
DNS.3 = 127.0.0.1
DNS.4 = fake1.local
DNS.5 = fake2.local</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the files are created, you’ll need to sign the certificate with the CA we created earlier:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">&gt; openssl x509 -req -sha256 -days 1024 -in localhost.csr -CA RootCA.pem -CAkey RootCA.key -CAcreateserial -extfile domains.ext -out localhost.crt</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run the next command to export the certificate:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">&gt; openssl pkcs12 -export -out localhost.pfx -inkey localhost.key -in localhost.crt</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will end up having something like this:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/certificates.png" alt="certificates">
</div>
<div class="title">Figure 22. Certification Authority (left) and localhost certificate signed by CA (right)</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_add-certificates-to-a-devon4net-project">Add certificates to a devon4net project</h5>
<div class="paragraph">
<p>Once you have created a certificate or in case you already have yours, you can add it to your project thanks to devon4net tools.</p>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_howto.asciidoc_step-1---add-it-to-your-project">Step 1 - Add it to your project</h6>
<div class="paragraph">
<p>Locate the Certificates directory in your startup project. If it doesn’t exist, please create it and drop your certificate <code>.pfx</code> as shown in figure 2.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/certificates_add.png" alt="certificates add">
</div>
<div class="title">Figure 23. Certificates directory in startup project</div>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_howto.asciidoc_step-2---configure-your-appsettings">Step 2 - Configure your appsettings</h6>
<div class="paragraph">
<p>Now configure your certificate in <code>appsettings.Development.json</code>. For that, you’ll need to specify the file name and the password you chose. Look for the <code>ServerCertificate</code> configuration and add something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"Certificates": {
    "ServerCertificate": {
        "Certificate": "localhost.pfx",
        "CertificatePassword": "12345"
    },
    "ClientCertificate": {
        "DisableClientCertificateCheck": true,
        "RequireClientCertificate": false,
        "CheckCertificateRevocation": true,
        "ClientCertificates": {
        "Whitelist": [
            "3A87A49460E8FE0E2A198E63D408DC58435BC501"
            ]
        }
    }
},</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_howto.asciidoc_references_3">References</h5>
<div class="paragraph">
<p>Here are some interesting references to continue learning about this topic:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/openssl/openssl">OpenSSL</a></p>
</li>
<li>
<p><a href="https://www.openssl.org/docs/man1.0.2/man1/openssl-req.html"><code>req</code> command documentation - OpenSSL Docs</a></p>
</li>
<li>
<p><a href="https://www.openssl.org/docs/man1.0.2/man1/x509.html"><code>x509</code> command documentation - OpenSSL Docs</a></p>
</li>
<li>
<p><a href="https://www.openssl.org/docs/man3.0/man1/pkcs12.html"><code>pkcs12</code> command documentation - OpenSSL Docs</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-setup-jwt">How to: Setup JWT</h4>
<div class="paragraph">
<p>As you may have learned at this point you can set up JWT component in a number of different ways according your needs. For that you’ll need to configure your <code>appsettings.json</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Please read documentation about JWT component first to learn what you need to do to use it in your project.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Assuming that you already have the JWT component correctly installed and available in our project let’s start thinking about how we can put it to good use.</p>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_howto.asciidoc_configuration">Configuration</h5>
<div class="paragraph">
<p>We can configure it to work either with a secret key or a certificate.</p>
</div>
<div class="paragraph">
<p>If you choose certificate, you will need to add a certificate to your project, and specify the password and the encryptionAlgorithm used. You can learn how to do it following the tutorial included in this document.</p>
</div>
<div class="paragraph">
<p>If you specify both, the secret key will take priority.</p>
</div>
<div class="paragraph">
<p>For example lets specify the next:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/json_jwt_example.png" alt="json jwt example">
</div>
<div class="title">Figure 24. JWT configuration example</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The property <code>SecretKey</code> needs to be an encrypted key using the algorithm specified.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>This would create the following configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A token with audience and issuer equal to <code>devon4net</code>.</p>
</li>
<li>
<p>It will expire in 60 minutes</p>
</li>
<li>
<p>It will validate the signature and if the token is valid in time</p>
</li>
<li>
<p>It will require tokens that are signed, and have both expiration time and audience specified.</p>
</li>
<li>
<p>It will use the secret key encrypted with SHA 512</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_claims">Claims</h5>
<div class="paragraph">
<p>Json Web Tokens work with claims. A Claim is a piece of information about a subject. It is similar to a key-value pair, where the value will be the claim type, such as the name or the role of an authenticated user. This claims are stored inside a JSON and then encrypted forming the JWT.</p>
</div>
<div class="paragraph">
<p>In .Net we can create Claims using the <code>Claim</code> class avaiable in <code>System.Security.Claims</code>. It has many constructors but the most important is the following one, where you can create a Claim based on two strings.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">var nameClaim = new Claim(ClaimType.Name, "DevonUser");
var roleClaim = new Claim(ClaimType.Role, "Administrator");</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can choose between a variety of claim types thanks to the <code>ClaimType</code> class. As you can see in the previous piece of code, in this case we have asserted a name and a role in two claims. This could be for a user, for example.</p>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_jwthandler">JwtHandler</h5>
<div class="paragraph">
<p>In JWT component we have a handler that is cofigured on the installation of the package and can be injected for use in any wanted service. This is the <code>JwtHandler</code>. This handler will allow us to manipulate, encrypt and extract information from Json Web Tokens.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Return Type</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Method Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Parameters</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CreateJwtToken</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List&lt;Claim&gt; clientClaims</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the encrypted jwt given a list of claims.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">List&lt;Claim&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GetUserClaims</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string jwtToken</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a list of claims given an encrypted token.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GetClaimValue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List&lt;Claim&gt; claimList, string claim</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the value of a claim given a list of claims and the type of the claim to recover formatted as a string.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GetClaimValue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string token, string claim</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the value of a claim given an encrypted token and the type of the claim to recover formatted as a string.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SecurityKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GetIssuerSigningKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the issuer’s signing key.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ValidateToken</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string jwtToken, out ClaimsPrincipal claimsPrincipal, out SecurityToken securityToken</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if the token is valid.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CreateRefreshToken</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Creates a refresh token for the JWT token.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_howto.asciidoc_video">Video</h5>

</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_howto.asciidoc_references_6">References</h5>
<div class="paragraph">
<p>Here are some interesting references to continue learning about this topic:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://auth0.com/docs/secure/tokens/json-web-tokens/json-web-token-claims">JSON Web Token Claims - auth0</a></p>
</li>
<li>
<p><a href="https://docs.microsoft.com/es-es/dotnet/api/system.security.claims.claim?view=net-6.0">Claim Class - Microsoft Docs</a></p>
</li>
<li>
<p><a href="https://docs.microsoft.com/es-es/dotnet/api/system.security.claims.claimtypes?view=net-6.0">ClaimTypes Class - Microsoft Docs</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-setup-security-and-roles-in-api-controllers">How to: Setup security and roles in API controllers</h4>
<div class="paragraph">
<p>In this part of the document, you will learn to use the different attributes over the controller methods that manage end-points. This attributes are provided by .Net core libraries and can be used to specify the behavior of Web API controllers and action methods.</p>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_attributtes">Attributtes</h5>
<div class="paragraph">
<p>You can use a large number of attributes, some are optional, for example to define the route of end-points <code>[Route("/GetSomething")]</code> and other are required, like <code>[ApiController]</code> to indicate that the class is an API controller.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
We will be explaining the security related attributes. Those that are specific to the controllers will not be mentioned.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><a id="devonfw-guide_devon4net.wiki_howto.asciidoc_httpoptions"></a>]
==== [HttpOptions]</p>
</div>
<div class="paragraph">
<p>This attribute identifies an API controller end-point that support the HTTP OPTIONS request. The HTTP OPTIONS method is used to get information about the communication options available for a specific URL or server.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Please do your research on this method if you are not familiar with it.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p><a id="devonfw-guide_devon4net.wiki_howto.asciidoc_allowanonymous"></a>]
==== [AllowAnonymous]</p>
</div>
<div class="paragraph">
<p><code>AllowAnonymous</code> allows any type of user (authorized or unauthorized) to access the information provided by the end-point. This attribute can be specified for controller class or for individual end-points. Specifying it for individual end-points will override the controller attribute. An example could be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">[HttpGet]
[AllowAnonymous]
[Route("/v1/getsomething")]
public async Task&lt;IActionResult&gt; GetSomething()
{
  ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a id="devonfw-guide_devon4net.wiki_howto.asciidoc_authorize"></a>]
==== [Authorize]</p>
</div>
<div class="paragraph">
<p><code>Authorize</code> only enables you to restrict access to requests with an authorization specified in the header. This attribute can be specified for controller class or for individual end-points. Specifying it for individual end-points will override the controller attribute. You can specify different properties to the attribute:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Property</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Type</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Example</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AuthenticationSchemes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of strings separated by comma</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of schemes from which user info is constructed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[Authorize(AuthenticationSchemes = "Bearer")]</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Policy</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Policy name that determines access to the resource</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[Authorize(Policy = "MyPolicy")]</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Roles</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of strings separated by comma</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of roles allowed to access</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[Authorize(Roles = "User")]</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For example, lets create a controller that is authorized only for users with role 'Admin' and 'Tester' provided in 'Bearer' type authentication:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">[ApiController]
[Route("[controller]")]
[Authorize(AuthenticationSchemes = "Berarer", Roles = "Admin,Tester")]
public class DebugController: ControllerBase
{
  ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>[[devonfw-guide_devon4net.wiki_howto.asciidoc_enablecors—​disablecors]]]
==== [EnableCors] &amp; [DisableCors]</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Please refer to the CORS component documentation to learn everything about CORS.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>You can enable a Cors policy for controller or individual end-points. Specifying it for individual end-points will override the controller attribute. You will need to specify the policy you want to enable. This policy will need to be described in the <code>appsettings.{environment}.json</code>.</p>
</div>
<div class="paragraph">
<p>For example, lets create a CORS policy named 'CorsPolicy' and enable it for a controller, and disable it for a method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"Cors": //[], //Empty array allows all origins with the policy "CorsPolicy"
[
  {
    "CorsPolicy": "CorsPolicy",
    "Origins": "http://localhost:4200,https://localhost:4200,http://localhost,https://localhost;http://localhost:8085,https://localhost:8085",
    "Headers": "accept,content-type,origin,x-custom-header,authorization",
    "Methods": "GET,POST,HEAD,PUT,DELETE",
    "AllowCredentials": true
  }
],</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">[ApiController]
[Route("[controller]")]
[EnableCors("CorsPolicy")]
public class MyController: ControllerBase
{
  ...
  [HttpGet]
  [Route("/v1/getsomething")]
  [DisableCors]
  public async Task&lt;IActionResult&gt; GetSomething()
  {
    ...
  }
  ...
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_howto.asciidoc_references_7">References</h5>
<div class="paragraph">
<p>Here are some interesting references to continue learning about this topic:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.microsoft.com/en-us/aspnet/core/security/authorization/introduction?view=aspnetcore-6.0">Introduction to authorization in ASP.NET Core - Microsoft Docs</a></p>
</li>
<li>
<p><a href="https://docs.microsoft.com/es-ES/dotnet/api/microsoft.aspnetcore.authorization?view=aspnetcore-6.0">Authorization Namespace - Microsoft Docs</a></p>
</li>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/OPTIONS">HTTP OPTIONS - MDN Web Docs</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-avoid-cross-site-request-forgery-xsrf-or-csrf-attacks">How to: Avoid cross-site request forgery (XSRF or CSRF) attacks</h4>
<div class="paragraph">
<p>Every time you authenticate into a web app, your browser becomes trusted for an amount of time to that specific site. This way you can use the application without having to authenticate yourself each time you want to do an operation that requires authorization. This is achieved normally by providing authentication tokens that last a determinate amount of time.</p>
</div>
<div class="paragraph">
<p>Your browser includes in each request a token issued by the app at the moment of authentication, the app verifies it and then sends back the response. A cross-site request forgery is a type of attack where a malicious site can use your authentication token to issue requests through your browser.</p>
</div>
<div class="paragraph">
<p>This is done, without you even noticing and it works because browser requests automatically include all session cookies. So if the request is done from another site with all these cookies (including your authentication cookie) it wont be different from you actually doing the request.</p>
</div>
<div class="paragraph">
<p>For example, you enter the site <code>vulnerable-bank.com</code> and forget to log out after doing all of your operations. Now you are surfing the net and enter the site <code>malicious-site.com</code> this site has a hidden script that performs the following request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>POST /transaction HTTP/1.1
Host: vulnerable-bank.com
Content-Type: application/x-www-form-urlencoded
Cookie: SessionID = 1n4j0sd7uohpf13j98nh570923c48u

account={MaliciousAccount}
amount=1000</code></pre>
</div>
</div>
<div class="paragraph">
<p>As all the session cookies are included in the request, the site will be allowed to process the transaction without you even noticing.</p>
</div>
<div class="paragraph">
<p>The most common way to prevent this vulnerability is by making use of anti forgery tokens. This token is placed in the headers and is issued with the request. The malicious-site cannot</p>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_howto.asciidoc_configuration_8">Configuration</h5>
<div class="paragraph">
<p>To configure Anti-Forgery protection in a devon4net project, you must set <code>UseXsrf</code> property in <code>devonfw</code> configuration section to true. You will find this section in <code>appsettings.json</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "devonfw": {
    "UseXsrf": true
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Setting this property to true will allow you to use <a href="https://docs.microsoft.com/es-es/dotnet/api/microsoft.aspnetcore.antiforgery.iantiforgery?view=aspnetcore-6.0"><code>IAntiforgery</code></a> interface through the service provider and dependency injection in your project.</p>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_use">Use</h5>
<div class="paragraph">
<p>In the devon4net Web API Templaate you will be able to find an example of controller using this protection. You can inject the <code>IAntiforgery</code> interface in the controller constructor like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">private readonly IAntiforgery _antiForgeryToken;

public AntiForgeryTokenController(IAntiforgery antiForgeryToken)
{
    _antiForgeryToken = antiForgeryToken;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you can access its methods to manage this special token. For creating one we can use <code>GetAndStoreTokens(HttpContext httpContext)</code> method available on <code>IAntiforgery</code>, and store it in the cookies as shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">var token = _antiForgeryToken.GetAndStoreTokens(HttpContext);
HttpContext.Response.Cookies.Append(CustomMiddlewareHeaderTypeConst.XsrfToken, token.RequestToken);</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Visit the documentation about this interface to find more information about <code>IAntiforgery</code> methods.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>This will be done through a GET request. Now we can vaklidate this token in a controller thanks to the attribute <code>[ValidateAntiForgeryToken]</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">[HttpGet]
[Route("/v1/antiforgeryToken/hellosecured")]
[ValidateAntiForgeryToken]
public ActionResult HelloSecured()
{
    return Ok("You have reached a secured AntiForgeryToken method!");
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_testing">Testing</h5>
<div class="paragraph">
<p>We will be using <a href="https://www.postman.com/">Postman</a> to test the use of the controller, as you can see in the next figure, if we try to access the end-point protected by the antiforgery token validation we get an error:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/anti_forgery_hellosecure_error.png" alt="anti forgery hellosecure error">
</div>
<div class="title">Figure 25. HelloSecured end-point error</div>
</div>
<div class="paragraph">
<p>That is beacuse no valid token in <code>XSRF-TOKEN</code> header is specified. Lets access the end-point we created to provide an XSRF token:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/anti_forgery_token.png" alt="anti forgery token">
</div>
<div class="title">Figure 26. Get XSRF token end-point</div>
</div>
<div class="paragraph">
<p>Now that we have the token we can specify it in the request header as shown in the next figure:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/anti_forgery_hellosecure_xsrf.png" alt="anti forgery hellosecure xsrf">
</div>
<div class="title">Figure 27. HelloSecured end-point access</div>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_howto.asciidoc_references_9">References</h5>
<div class="paragraph">
<p>Here are some interesting references to continue learning about this topic:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://owasp.org/www-community/attacks/csrf">Cross Site Request Forgery (CSRF) - Owasp</a></p>
</li>
<li>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html">Cross Site Request Forgery Prevention Cheat Sheet - Owasp</a></p>
</li>
<li>
<p><a href="https://docs.microsoft.com/en-us/aspnet/core/security/anti-request-forgery?view=aspnetcore-6.0">Prevent Cross-Site Request Forgery (XSRF/CSRF) attacks in ASP.NET Core - Microsoft Docs</a></p>
</li>
<li>
<p><a href="https://docs.microsoft.com/es-es/dotnet/api/microsoft.aspnetcore.antiforgery.iantiforgery?view=aspnetcore-6.0">IAntiforgery Interface - Microsoft Docs</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-import-a-database">How to: Import a database</h4>
<div class="paragraph">
<p>In this part of the document you will learn how to easily import a database to your devon4net project or any .Net project. This process is known by a variety of different names: scaffolding, database first, reverse engineering…​ But they all refer to the process of creating entity models and/or database context automatically based on a database schema.</p>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_prerequisites">Prerequisites</h5>
<div class="paragraph">
<p>You can import a database in your favourite type of schema, but for this example we will be using SQL Server and Visual Studio 2022.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Ensure that you have a connection ready to your database and a correct installation of Visual Studio 2022.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>For this example we used <a href="https://docs.microsoft.com/es-es/sql/ssms/download-sql-server-management-studio-ssms?view=sql-server-ver15">Microsoft SQL Server Management Studio</a> to create our database and provide us with a local database connection.</p>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_nuget-packages-installation">NuGet packages installation</h5>
<div class="paragraph">
<p>Before starting with the scaffolding you will need to install the following NuGet packages in your destination project.</p>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_howto.asciidoc_open-the-package-manager-console">Open the Package Manager Console</h6>
<div class="paragraph">
<p>To open the Package Manager Console, follow the next menu steps: <code>View &gt; Other Windows &gt; Package Manager Console</code> and then ensure that the default project in the console is set to the destination project as shown in the next figure.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If the destination project is not the same as the startup project, you may need to install some of the packages in the startup project too. The package manager console will warn you of that if it is necessary.
</td>
</tr>
</tbody></table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pacakge_manager_console.png" alt="pacakge manager console">
</div>
<div class="title">Figure 28. Package Manager Console default project</div>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_howto.asciidoc_install-the-packages">Install the packages</h6>
<div class="ulist">
<ul>
<li>
<p>Microsoft.EntityFrameworkCore.Tools</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">install-package Microsoft.EntityFrameworkCore.Tools</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Microsoft.EntityFrameworkCore.Design</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">install-package Microsoft.EntityFrameworkCore.Design</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>MIcrosoft.EntityFrameworkCore.SqlServer</p>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
As we mentioned we will be using a SQL Server schema, we are installing the database provider for it. Please choose your own <a href="https://docs.microsoft.com/en-us/ef/core/providers/?tabs=dotnet-core-cli">Database Provider</a>.
</td>
</tr>
</tbody></table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">install-package Microsoft.EntityFrameworkCore.SqlServer</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_scaffolding-command">Scaffolding command</h5>
<div class="paragraph">
<p>Run the following command to execute the scaffolding operation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">scaffold-dbcontext 'Server=(localdb)\mssqllocaldb;Database=DevonDatabase;' Microsoft.EntityFrameworkCore.SqlServer -Tables School,Teacher -ContextDir Domain\Database -OutputDir Domain\Entities</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Your connection string and database provider may be different.
</td>
</tr>
</tbody></table>
</div>
<div class="ulist">
<ul>
<li>
<p>The first argument is the connection string.</p>
</li>
<li>
<p>The second argument is the Database Provider package for the used schema.</p>
</li>
<li>
<p><code>-Tables {Table list separated by comma}</code> is the list of the tables you want to scaffold.</p>
</li>
<li>
<p><code>-ContextDir</code> will specify the relative path for the context.</p>
</li>
<li>
<p><code>-OutputDir</code> will specify the relative path for the models.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In our case, before doing the scaffolding we had something like this:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/before_scaffolding.png" alt="before scaffolding">
</div>
<div class="title">Figure 29. Directory tree before scaffolding</div>
</div>
<div class="paragraph">
<p>And the scaffolding produced the following directory tree:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/after_scaffolding.png" alt="after scaffolding">
</div>
<div class="title">Figure 30. Directory tree after scaffolding</div>
</div>
<div class="paragraph">
<p>If you do not specify <code>-Tables</code>, <code>-ContextDir</code> and <code>-OutputDir</code> all of the tables will be scaffolded and the default directories will be the project directory.</p>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_add-the-context-for-dependency-injection">Add the context for Dependency Injection</h5>
<div class="paragraph">
<p>Now that we have our context we will need to add it either in <code>Program.cs</code> or <code>SetupDatabase</code> method in <code>DevonConfiguration</code> class.</p>
</div>
<div class="paragraph">
<p>As we are using Devon, we will need to go to <code>Devon4Net.Application.WebAPI.Implementation.Configuration.DevonConfiguration</code> and add the folowing line in <code>SetupDatabase</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">services.SetupDatabase&lt;DevonDatabaseContext&gt;(configuration,"DevonDatabase", DatabaseType.SqlServer).ConfigureAwait(false);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Parameter</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;DevonDatabaseContext&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database context you want to add</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>configuration</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Available <code>IConfiguration</code> instance</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"DevonDatabase"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the connection string defined at <code>ConnectionString</code> section in the <code>appsettings.{environment}.json</code> configuration file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DatabaseType</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database schema available in devon (see the following list).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>List of supported databases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SqlServer</p>
</li>
<li>
<p>Sqlite</p>
</li>
<li>
<p>InMemory</p>
</li>
<li>
<p>Cosmos</p>
</li>
<li>
<p>PostgreSQL</p>
</li>
<li>
<p>MySql</p>
</li>
<li>
<p>MariaDb</p>
</li>
<li>
<p>FireBird</p>
</li>
<li>
<p>Oracle</p>
</li>
<li>
<p>MSAccess</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_howto.asciidoc_references_10">References</h5>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.microsoft.com/en-us/ef/core/managing-schemas/scaffolding?tabs=vs">Reverse Engineering - Microsoft Docs</a></p>
</li>
<li>
<p><a href="https://docs.microsoft.com/en-us/ef/core/providers/?tabs=dotnet-core-cli">Database Providers - Microsoft Docs</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-use-litedb">How to: Use LiteDb</h4>
<div class="paragraph">
<p>In this part you will learn how to easily start using a LiteDb database in your project.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Please read the documentation of this component to learn more about how to set it up and use it.
</td>
</tr>
</tbody></table>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_howto.asciidoc_video_11">Video</h5>
<div class="paragraph">
<p>As you will find all the information in the component documentation, we prepared a video using LiteDb in a very short example:</p>
</div>
<div class="videoblock">
<div class="title">How to setup and use LiteDb component</div>
<div class="content">
<video src="videos/howto_litedb.mp4" controls="">
Your browser does not support the video tag.
</video>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-customize-headers">How to: Customize Headers</h4>
<div class="paragraph">
<p>HTTP headers let the client and the server provide additional information with an HTTP request or a response. As this headers provide information about either the client or the server, it can be dangerous if this information lands in the wrong hands.</p>
</div>
<div class="paragraph">
<p>As Owasp explains in great detail, proper HTTP headers can help prevent security vulnerabilities like Cross-Site Scripting, Clickjacking, Information disclosure and more.</p>
</div>
<div class="paragraph">
<p>In devon we take security very seriously, that’s why we developed a very easy form of customizing HTTP headers. You will be able to do it configuring the headers in the <code>appsettings.{environment}.json</code> file. A middleware will be configured with those options and will modify each HTTP response according to the specified options.</p>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_howto.asciidoc_configuration_12">Configuration</h5>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"Headers": {
    "AccessControlExposeHeader": "Authorization",
    "StrictTransportSecurityHeader": "",
    "XFrameOptionsHeader": "DENY",
    "XssProtectionHeader": "1;mode=block",
    "XContentTypeOptionsHeader": "nosniff",
    "ContentSecurityPolicyHeader": "",
    "PermittedCrossDomainPoliciesHeader": "",
    "ReferrerPolicyHeader": ""
  },</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following table shows the options that can be configured.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Please refer to the links provided to learn more about each header and what can be done with it.
</td>
</tr>
</tbody></table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Option</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Header</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AccessControlExposeHeader</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://developer.mozilla.org/es/docs/Web/HTTP/Headers/Access-Control-Expose-Headers"><code>Access-Control-Expose-Headers</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates which headers may be exposed as part of the response by listing their names.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>StrictTransportSecurityHeader</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://developer.mozilla.org/es/docs/Web/HTTP/Headers/Strict-Transport-Security"><code>Strict-Transport-Security</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows a website to tell browsers that it should only communicate with HTTPS instead of using HTTP.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>XFrameOptionsHeader</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://developer.mozilla.org/es/docs/Web/HTTP/Headers/X-Frame-Options"><code>X-Frame-Options</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can be used to indicate whether a browser should be allowed to render a page in a <code>&lt;frame&gt;</code>, <code>&lt;iframe&gt;</code>, <code>&lt;embed&gt;</code> or <code>&lt;object&gt;</code>, to prevent attacks such as click-jacking.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>XssProtectionHeader</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://developer.mozilla.org/es/docs/Web/HTTP/Headers/X-XSS-Protection"><code>X-XSS-Protection</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prevents the loading of a page when it detects cross-site attacks.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>XContentTypeOptionsHeader</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://developer.mozilla.org/es/docs/Web/HTTP/Headers/X-Content-Type-Options"><code>X-Content-Type-Options</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">It is a flag used by the server to indicate that the MIME types advertised in the <code>Content-Type</code> headers should not be changed or followed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ContentSecurityPolicyHeader</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://developer.mozilla.org/es/docs/Web/HTTP/Headers/Content-Security-Policy"><code>Content-Security-Policy</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows the administrators of a website to control the resources that the User-Agent can upload to a page.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PermittedCrossDomainPoliciesHeader</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://owasp.org/www-project-secure-headers/#x-permitted-cross-domain-policies"><code>X-Permitted-Cross-Domain-Policies</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Grants a web client ermission to handle data across domains.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ReferrerPolicyHeader</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://developer.mozilla.org/es/docs/Web/HTTP/Headers/Referrer-Policy"><code>Referrer-Policy</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines which referrer data, among those sent with the <code>Referer</code> header, should be included with the requests made.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If the response header does not have a value or does not appear in the optons, it will not be added to the response headers.
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_howto.asciidoc_references_13">References</h5>
<div class="ulist">
<ul>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers">HTTP headers - MDN Web Docs</a></p>
</li>
<li>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html">HTTP Security Response Headers Cheat Sheet - Owasp</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-specflow">How to: Specflow</h4>
<div class="paragraph">
<p>In this part of the document you will learn to use Specflow in your projects for defining, managing and automatically execute readable acceptance tests in .NET.</p>
</div>
<div class="paragraph">
<p>SpecFlow is a.NET test automation tool based on the BDD (Behavior-driven development) paradigm. Specflow tests use the Gherking language to write test cases that are then bound to your application code through bindings, allowing you to run the tests using your preferred testing framework.</p>
</div>
<div class="paragraph">
<p>Before going into detail on how to use Specflow and how you can use it to implement your tests, you will need know Gherking syntax. It is used to write tests in a form that can be readed perfectly as a sentence. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-gherkin" data-lang="gherkin">Feature: Calculator
  Scenario: Sum two numbers
    Given the first number is 10
    And the second number is  5
    When the two values are added
    Then the result is 15</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, thanks to Gherkin we have written a test for a calculator, which makes sure that when the values ​​<code>10</code> and <code>5</code> are added, the result is <code>15</code>. Because is a natural-language friendly language you can read the test, and understand the statement.</p>
</div>
<div class="paragraph">
<p>The following table shows the keywords used in Gherkin syntax:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Keyword</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Feature</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides high level description of a software feature that wants to be tested and group related scenarios.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Rule</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Represents one business rule that should be implemented.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Scenario</code> or <code>Example</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of steps that ilustrates a business rule.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Steps</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Each step starts with <code>Given</code>, <code>When</code>, <code>Then</code>, <code>And</code> or <code>But</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Background</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scenario context run before the <code>Scenario</code> tests but after <code>Before Hooks</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Scenario Outline</code> or <code>Scenario Template</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">It is used to run the same <code>Scenario</code> multiple times, with different combinations of values.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Scenarios</code> or <code>Examples</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keyword used to define the variables of <code>Scenario Outline</code> in a table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>""</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Strings</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tags</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comments</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>|</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tables</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-gherkin" data-lang="gherkin"># Test for the calculator
@mytag
Feature: Calculator
  Scenario Outline: Sum two numbers
    Given the first number is &lt;first&gt;
    And the second number is  &lt;second&gt;
    When the two values are added
    Then the result is &lt;result&gt;

    Examples:
    | first | second | result |
    |    10 |   5    |   15   |
    |    20 |   5    |   25   |</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Please refer to the <a href="https://cucumber.io/docs/gherkin/">Cucumber Documentation</a> or <a href="https://specflow.org/learn/gherkin/">Specflow Documentation</a> to learn more about the keywords used in Gherkin.
</td>
</tr>
</tbody></table>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_specflow-installation">Specflow Installation</h5>
<div class="paragraph">
<p>To use specflow you will need to add the Specflow extension to your Visual Studio 2022. This way you can use it in any of your projects. For that open visual studio and navigate to <code>Extensions &gt; Manage Extensions</code>.</p>
</div>
<div class="paragraph">
<p>This will open the extension manager, where you will have to search for the 'SpecFlow' extension and hit download:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/specflow_extension.png" alt="specflow extension">
</div>
<div class="title">Figure 31. SpecFlow for VS 2022 in Extension Manager</div>
</div>
<div class="paragraph">
<p>Hitting download will schedule the extension installation. At the time when you close VS2022, you will be able to install the extension by clicking <code>Modify</code> in the pop-up window shown below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/specflow_installation.png" alt="specflow installation">
</div>
<div class="title">Figure 32. SpecFlow installation</div>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_create-specflow-project">Create specflow project</h5>
<div class="paragraph">
<p>To create a specflow project for testing, first we will need to have something to test. In this example we will test a Calculator class that we created inside a class library project in an empty solution like shown in the following image:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/specflow_directory_tree.png" alt="specflow directory tree">
</div>
<div class="title">Figure 33. SpecFlowTest solution directory tree</div>
</div>
<div class="paragraph">
<p>Where, the <code>Calculator</code> class implementation is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public class Calculator
{
    public int FirstNumber { get; set; }
    public int SecondNumber { get; set; }

    protected int Add()
    {
        return FirstNumber + SecondNumber;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once we have the Calculator ready, we need to create a Specflow project. For that you can <code>Right click on the solution &gt; Add &gt; New Project…​</code>. This will open a window where you can search the specflow project as shown in the next image:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/new_specflow_project.png" alt="new specflow project">
</div>
<div class="title">Figure 34. Add new SpecFlow project</div>
</div>
<div class="paragraph">
<p>When creating the project you will be able to choose the .Net version that you are using, the library for the tests and if you want to use FluentAssertions library. For this example we will use the configuration shown below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/new_specflow_options.png" alt="new specflow options">
</div>
<div class="title">Figure 35. Choose the project options</div>
</div>
<div class="paragraph">
<p>The specflow template comes with a calculator test implemented, this is their example. But we will create the files from scratch so you know how to complete your testing project.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/specflow_project_structure.png" alt="specflow project structure">
</div>
<div class="title">Figure 36. Initial project structure</div>
</div>
<div class="paragraph">
<p>As you can see also the template comes with a folder structure defined, you can redifine it as you want but this is the recommended one.</p>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_create-specflow-tests">Create specflow tests</h5>
<div class="paragraph">
<p>To create a new test using specflow, you can add a new item to your project by <code>Right click in any directory on the project &gt; Add &gt; New item…​</code>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/new_specflow_feature.png" alt="new specflow feature">
</div>
<div class="title">Figure 37. Initial project structure</div>
</div>
<div class="paragraph">
<p>You can type specflow in the search bar to look for the items available thanks to the library and select <code>Feature File for Specflow</code>. You can create a test there in Gherkin syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-Gherkin" data-lang="Gherkin">Feature: Calculator

A short summary of the feature

@mytag
Scenario: Add two numbers
	Given the first number is 50
	And my favourite number is 70
	When the two numbers are added
	Then the result should be 120</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once you have your test created you can build the project by navigating to <code>Build &gt; Build Solution</code>. You will see that the test appears in a purple color, this is because it is not mapped to a definition yet. You can automatically create the definition by <code>Right clicking inside the feature file &gt; Define Steps</code>.</p>
</div>
<div class="paragraph">
<p>This will open the following window:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/define_steps.png" alt="define steps">
</div>
<div class="title">Figure 38. Define SpecFlow Steps</div>
</div>
<div class="paragraph">
<p>Once you press <code>Create</code> the test will no longer appear in purple and will be shown in a white color. This is because now they have a definition. You can also do this manually creating a class and marking it with the <code>[Binding]</code> attribute.</p>
</div>
<div class="paragraph">
<p>This class will need to define the test steps such as Gherkin syntax can be transformed into <code>C#</code> code. You can implement this class as follows to test the Calculator:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">using SpecflowCalculator;

namespace SpecFlowProject.StepDefinitions
{
    [Binding]
    public class CalculatorStepDefinitions
    {
        private Calculator _calculator;
        private int _result;

        public CalculatorStepDefinitions()
        {
            _calculator = new Calculator();
        }

        [Given(@"the first number is (.*)")]
        public void GivenTheFirstNumberIs(int p0)
        {
            _calculator.FirstNumber = p0;
        }

        [Given(@"my favourite number is (.*)")]
        public void GivenMyFavouriteNumberIs(int p0)
        {
            _calculator.SecondNumber = p0;
        }

        [When(@"the two numbers are added")]
        public void WhenTheTwoNumbersAreAdded()
        {
            _result = _calculator.Add();
        }

        [Then(@"the result should be (.*)")]
        public void ThenTheResultShouldBe(int p0)
        {
            // xUnit assertions
            Assert.Equal(_result, p0);

            // FluentAssertions
            _result.Should().Be(p0);
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now build the solution again to be able to run the tests.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Please revise the <a href="https://specflow.org/learn/gherkin/">Specflow Documentation</a> to learn more about feature bindings.
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_run-the-tests">Run the tests</h5>
<div class="paragraph">
<p>To run the tests you can navigate to <code>Test &gt; Test Explorer</code>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/specflow_test_explorer.png" alt="specflow test explorer">
</div>
<div class="title">Figure 39. VS2022 Test Explorer</div>
</div>
<div class="paragraph">
<p>By clicking the green play button you can run the tests and see the results as shown in the image above.</p>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_living-documentation">Living documentation</h5>
<div class="paragraph">
<p>SpecFlow Living Documentation is a set of tools that allows you to share and collaborate on Gherkin Feature Files. It gives you the option to generate and share an <code>html</code> interactive file. You can do this directly for Azure DevOps or using a CLI (Command Line Interface). In this guide you will learn how to do this with the CLI continuing with the Calculator example.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Please refer to the <a href="https://docs.specflow.org/projects/specflow-livingdoc/en/latest/">Specflow+LivingDoc</a> documentation to learn more.
</td>
</tr>
</tbody></table>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_howto.asciidoc_step-1---install-cli">Step 1 - Install CLI</h6>
<div class="paragraph">
<p>Install the tool by running the following command in your preferred terminal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">dotnet tool install --global SpecFlow.Plus.LivingDoc.CLI</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_howto.asciidoc_step-2---navigate-to-the-build-output-directory">Step 2 - Navigate to the build output directory</h6>
<div class="paragraph">
<p>Now we need to navigate to the build directory of the Specflow Project taht contains the tests. In our case we can navigate to this path by running the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">cd C:\Projects\devon4net\samples\SpecflowTest\SpecFlowProject\bin\Debug\net6.0</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Your path may be different depending on the root directory, the file structure of the solution and the .Net version you are using.
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_howto.asciidoc_step-3---run-command-to-generate-results">Step 3 - Run command to generate results</h6>
<div class="paragraph">
<p>To generate the file run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">livingdoc test-assembly SpecFlowProject.dll -t TestExecution.json</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_howto.asciidoc_step-4---see-html-results">Step 4 - See html results</h6>
<div class="paragraph">
<p>The file generated can be seen with your favorite browser and will look like this:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/specflow_html.png" alt="specflow html">
</div>
<div class="title">Figure 40. Specflow LivingDoc results</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_howto.asciidoc_references_14">References</h5>
<div class="ulist">
<ul>
<li>
<p><a href="https://cucumber.io/docs/gherkin/">Gherkin Syntax - Cucumber Docs</a></p>
</li>
<li>
<p><a href="https://specflow.org/learn/gherkin/">Learn Gherkin - Specflow Docs</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-circuit-breaker-communication-with-certificates">How To: Circuit breaker communication with Certificates</h4>
<div class="paragraph">
<p>In this section we are going to configure two services communication for using certificates, and Circuit Breaker Pattern.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Please refer to the component documentation for more information about how to configure <a href="devonfw-guide_devon4net.wiki_packages.asciidoc.html">CircuitBreaker</a> in devon4net and other projects
</td>
</tr>
</tbody></table>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_howto.asciidoc_configuration_15">Configuration</h5>
<div class="paragraph">
<p>We have to setup two services in order to implement Circuit Breaker pattern, in this scenario, we’re creating a basic application that connects two services that are similar.</p>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_howto.asciidoc_servicea">ServiceA</h6>
<div class="paragraph">
<p>In the <code>appsettings.{development}.json</code> you must use the following configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"CircuitBreaker": {
    "CheckCertificate": false,
    "Endpoints": [
      {
        "Name": "ServiceB",
        "BaseAddress": "https://localhost:5055",
        "Headers": {
        },
        "WaitAndRetrySeconds": [
          0.0001,
          0.0005,
          0.001
        ],
        "DurationOfBreak": 0.0005,
        "UseCertificate": true,
        "Certificate": "localhost.pfx",
        "CertificatePassword": "localhost",
        "SslProtocol": "Tls12", //Tls, Tls11,Tls12, Tls13, none
        "CompressionSupport": true,
        "AllowAutoRedirect": true
      }
    ]
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>As an example, we call the <code>HttpClientHandler</code> in the controller, however it is preferable to do it in the service class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">    [ApiController]
    [Route("[controller]")]
    public class PingController : ControllerBase
    {
        private IHttpClientHandler HttpClientHandler { get; }

        public PingController(IHttpClientHandler httpClientHandler)
        {
            HttpClientHandler = httpClientHandler;
        }

        /// &lt;summary&gt;
        /// Returs Ping!
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        [HttpGet]
        [HttpOptions]
        [Route("/v1/ping/")]
        [ProducesResponseType(typeof(string), StatusCodes.Status200OK)]
        [ProducesResponseType(StatusCodes.Status400BadRequest)]
        [ProducesResponseType(StatusCodes.Status401Unauthorized)]
        [ProducesResponseType(StatusCodes.Status403Forbidden)]
        [ProducesResponseType(StatusCodes.Status500InternalServerError)]
        public IActionResult Ping()
        {
            return Ok("Ping!");
        }

        /// &lt;summary&gt;
        /// Returs Ping!
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        [HttpGet]
        [HttpOptions]
        [Route("/v1/remoteping/")]
        [ProducesResponseType(typeof(string), StatusCodes.Status200OK)]
        [ProducesResponseType(StatusCodes.Status400BadRequest)]
        [ProducesResponseType(StatusCodes.Status401Unauthorized)]
        [ProducesResponseType(StatusCodes.Status403Forbidden)]
        [ProducesResponseType(StatusCodes.Status500InternalServerError)]
        public async Task&lt;IActionResult&gt; RemotePing()
        {
            var result = await HttpClientHandler.Send&lt;string&gt;(HttpMethod.Get, "ServiceB", "/v1/pong", null, MediaType.ApplicationJson);
            return Ok(result);
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>As shown in the code above, we inject the <code>HttpClientHandler</code>, and on the RemotePing() function, we use the HttpClientHandler’s Send method to communicate ServiceA with ServiceB.</p>
</div>
<div class="paragraph">
<p>The CircuitBreaker setup method must be added to Program.cs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">builder.Services.SetupCircuitBreaker(builder.Configuration);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Also, remember to install the certificate and add the folder containing the certificate to the project.</p>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_howto.asciidoc_serviceb">ServiceB</h6>
<div class="paragraph">
<p>ServiceB is implemented in the same way as ServiceA. You only have to change the name of the service and the base address in the <code>appsettings.{environment}.json</code>, and in the controller method you must change the service name and the endpoint:</p>
</div>
<div class="paragraph">
<p><strong><code>appsettings.Development.json</code></strong> :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json"> "CircuitBreaker": {
    "CheckCertificate": false,
    "Endpoints": [
      {
        "Name": "ServicioA",
        "BaseAddress": "https://localhost:9091",
        "Headers": {
        },
        "WaitAndRetrySeconds": [
          0.0001,
          0.0005,
          0.001
        ],
        "DurationOfBreak": 0.0005,
        "UseCertificate": true,
        "Certificate": "localhost.pfx",
        "CertificatePassword": "localhost",
        "SslProtocol": "Tls12", //Tls, Tls11,Tls12, Tls13, none
        "CompressionSupport": true,
        "AllowAutoRedirect": true
      }
    ]
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>PongController</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public async Task&lt;IActionResult&gt; RemotePong()
  {
    var result = await HttpClientHandler.Send&lt;string&gt;(HttpMethod.Get, "ServicioA", "/v1/ping", null, MediaType.ApplicationJson);
    return Ok(result);
  }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_howto.asciidoc_video_16">Video</h5>
<div class="paragraph">
<p>The preceding example is covered in detail in this video lesson:</p>
</div>
<div class="videoblock">
<div class="title">How to setup Circuit Breaker with certificates</div>
<div class="content">
<video src="videos/howto_circuitbreaker_certificates.mp4" controls="">
Your browser does not support the video tag.
</video>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-rabbitmq">How to: RabbitMQ</h4>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_configure-the-server">Configure the Server</h5>
<div class="paragraph">
<p>There are several methods to configure the RabbitMQ server, depending on your operating system.</p>
</div>
<div class="paragraph">
<p>In this tutorial, we will show you how to run a server via Docker, for testing purposes. If you want further information on how to configure and install the RabbitMQ server in a specific operating system, please consult the <a href="https://www.rabbitmq.com/download.html">official RabbitMQ documentation</a></p>
</div>
<div class="paragraph">
<p>First you must have docker installed on your machine. Run the following command to start the server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">docker run -it --rm --name rabbitmq -e RABBITMQ_DEFAULT_USER=admin -e RABBITMQ_DEFAULT_PASS=password -p 5672:5672 -p 15672:15672 rabbitmq:3.9-management</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command shows several options parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-it</code>: To create an interactive container</p>
</li>
<li>
<p><code>--rm</code>: To automatically clean up the container and remove the file system when the container exits.</p>
</li>
<li>
<p><code>--name</code>: The name of the container</p>
</li>
<li>
<p><code>-e</code>: Environment variables</p>
</li>
<li>
<p><code>-p</code>: To expose a container’s internal port</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The server will listen on port 5672, and you may access the management plugin at the following url:</p>
</div>
<div class="paragraph">
<p><a href="http://localhost:15672/" class="bare">http://localhost:15672/</a></p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/rabbit-management.png" alt="rabbit management">
</div>
<div class="title">Figure 41. RabbitMQ Management Plugin</div>
</div>
<div class="paragraph">
<p>You may customize your Docker container as you like, please see the <a href="https://registry.hub.docker.com/_/rabbitmq/">official Docker  image documentation</a> for more information.</p>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_configure-the-client">Configure the Client</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install the package in your solution using the Package Manager Console:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">Install-Package Devon4Net.Infrastructure.RabbitMQ</code></pre>
</div>
</div>
</li>
<li>
<p>Create a Configuration static class in order to add the <code>RabbitMqHandler</code> services, for example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#"> public static class Configuration
    {

        public static void SetupDependencyInjection(this IServiceCollection services, IConfiguration configuration)
        {

            var rabbitMq = serviceProvider.GetService&lt;IOptions&lt;RabbitMqOptions&gt;&gt;();

            if (rabbitMq?.Value != null &amp;&amp; rabbitMq.Value.EnableRabbitMq)
            {
                SetupRabbitHandlers(services);
            }
        }

        private static void SetupRabbitHandlers(IServiceCollection services)
        {
            services.AddRabbitMqHandler&lt;TodoRabbitMqHandler&gt;(true);
        }
    }</code></pre>
</div>
</div>
</li>
<li>
<p>Add the following lines in the <code>Program.cs</code> class:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">builder.Services.SetupRabbitMq(builder.Configuration);
builder.Services.SetupDependencyInjection(builder.Configuration);</code></pre>
</div>
</div>
</li>
<li>
<p>Configure the component in the file <code>appsettings.{environment}.json</code>, for example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">  "RabbitMq": {
    "EnableRabbitMq": true,
    "Hosts": [
      {
        "Host": "127.0.0.1",
        "Port": 5672,
        "Ssl": false,
        "SslServerName": "localhost",
        "SslCertPath": "localhost.pfx",
        "SslCertPassPhrase": "localhost",
        "SslPolicyErrors": "RemoteCertificateNotAvailable" //None, RemoteCertificateNotAvailable, RemoteCertificateNameMismatch, RemoteCertificateChainErrors
      }
    ],

    "VirtualHost": "/",
    "UserName": "admin",
    "Password": "password",
    "Product": "devon4net",
    "RequestedHeartbeat": 10, //Set to zero for no heartbeat
    "PrefetchCount": 50,
    "PublisherConfirms": false,
    "PersistentMessages": true,
    "Platform": "localhost",
    "Timeout": 10,
    "Backup": {
      "UseLocalBackup": true,
      "DatabaseName": "devon4netMessageBackup.db"
    }
  },</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>EnableRabbitMq</code>: True for enabling the RabbitMQ component</p>
</li>
<li>
<p><code>Hosts</code>: Host configuration, which might be a list of multiple hosts</p>
</li>
<li>
<p><code>VirtualHost</code>:  Virtual host’s name</p>
</li>
<li>
<p><code>UserName</code>: User’s name</p>
</li>
<li>
<p><code>Password</code>: password for connecting</p>
</li>
<li>
<p><code>RequestedHeartbeat</code>: The heartbeat timeout setting specifies how long the peer TCP connection should be considered unreachable by RabbitMQ and client libraries. Should be set to zero for no heartbeat.</p>
</li>
<li>
<p><code>PrefetchCount</code>:  The amount of messages transmitted by RabbitMQ before EasyNetQ sends a response.</p>
</li>
<li>
<p><code>PublisherConfirms</code>: True for enabling Publisher confirms that simply speaking is an AMQP extension that sends a callback when your message is successfully received by the broker.</p>
</li>
<li>
<p><code>PersistentMessages</code>: When set to true, RabbitMQ will retain messages to disk and survive server restarts. When set to false, performance increases might be expected.</p>
</li>
<li>
<p><code>Platform</code>: The value given here will be shown in the RabbitMQ management interface.</p>
</li>
<li>
<p><code>TimeOut</code>: Range from 0 to 65535. Format is in seconds. For infinite timeout please use 0. Throws System.TimeoutException when value exceeded.</p>
</li>
<li>
<p><code>Backup</code>: Configuration of Message’s BackUp. Its default database is LiteDB.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Check the <a href="devonfw-guide_devon4net.wiki_packages.asciidoc.html">RabbitMQ Component section</a> for examples of the component’s implementation and essential classes.
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_howto.asciidoc_references_17">References</h5>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.rabbitmq.com/documentation.html">RabbitMQ Documentation</a></p>
</li>
<li>
<p><a href="https://docs.docker.com/engine/reference/run/">Docker docs</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-kafka">How to: Kafka</h4>
<div class="paragraph">
<p>In this part of the document you will learn how to use kafka component and create and use Producers and Consumers for your application. You will also learn to use the different Handlers available in the <code>Devon4Net.Infrastructure.Kafka</code> component and how to configure them.</p>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_previous-steps">Previous steps</h5>
<div class="paragraph">
<p>To use Kafka you need to have an active Kafka server. There are multple ways to use a kafka server, we are using a docker image but you can choose any desired form.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
We recommend you to go through <a href="https://kafka.apache.org/">Kafka Documentation</a> to learn how to get started with Apache Kafka.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Once you have an Apache Kafka Server up and running you will need to create a project using the <code>Devon4Net</code> template or add <code>Devon4Net.Infrastructure.Kafka</code> NuGet package reference to your project.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can learn how to set up the component in your project by reading the component documentation.
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_howto.asciidoc_configuration_18">Configuration</h5>
<div class="paragraph">
<p>When you have both things ready, you can start by adding the following line in your <code>Program.cs</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">builder.Services.SetupKafka(builder.Configuration);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now is the time to configure all the producers and consumers you will be using in the application. You will later be relating this configuration to the Consumer and Producer Handler classes. For that you will need to complete the following configuration in <code>appsettings.{environment}.json</code> file with your preferred parameters.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"Kafka": {
    "EnableKafka": true,
    "Administration": [
      {
        "AdminId": "Admin1",
        "Servers": "127.0.0.1:9092"
      }
    ],
    "Producers": [
      {
        "ProducerId": "Producer1",
        "Servers": "127.0.0.1:9092",
        "ClientId": "client1",
        "Topic": "devonfw",
        "MessageMaxBytes": 1000000,
        "CompressionLevel": -1,
        "CompressionType": "None",
        "ReceiveMessageMaxBytes": 100000000,
        "EnableSslCertificateVerification": false,
        "CancellationDelayMaxMs": 100,
        "Ack": "None",
        "Debug": "",
        "BrokerAddressTtl": 1000,
        "BatchNumMessages": 1000000,
        "EnableIdempotence": false,
        "MaxInFlight": 5,
        "MessageSendMaxRetries": 5,
        "BatchSize": 100000000
      }
    ],
    "Consumers": [
      {
        "ConsumerId": "Consumer1",
        "Servers": "127.0.0.1:9092",
        "GroupId": "group1",
        "Topics": "devonfw",
        "AutoCommit": true,
        "StatisticsIntervalMs": 0,
        "SessionTimeoutMs": 10000,
        "AutoOffsetReset": "Largest",
        "EnablePartitionEof": true,
        "IsolationLevel": "ReadCommitted",
        "EnableSslCertificateVerification": false,
        "Debug": ""
      }
    ]
  }</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Please refer to the component documentation to learn more about the configuration.
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_producer">Producer</h5>
<div class="paragraph">
<p>After defining the configuration in the <code>appsettings.{environment}.json</code> now you can create your handlers extending the ones available in the Kafka component.</p>
</div>
<div class="paragraph">
<p>For the producer you can do something as the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public class MessageProducerHandler : KafkaProducerHandler&lt;string,string&gt;
{
    public MessageProducerHandler(IServiceCollection services, IKakfkaHandler kafkaHandler, string producerId) : base(services, kafkaHandler, producerId)
    {
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will need to add this handler to your dependencies. For that you can use the following method, and include the <code>Id</code> of the configuration as a parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">builder.Services.AddKafkaProducer&lt;MessageProducerHandler&gt;("Producer1");</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you can use the handler in any constructor via dependency injection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public class KafkaController : ControllerBase
{
    private MessageProducerHandler MessageProducer { get; }

    public KafkaController(MessageProducerHandler messageProducer)
    {
        MessageProducer = messageProducer;
    }

    [HttpPost]
    [AllowAnonymous]
    [ProducesResponseType(typeof(DeliveryResult&lt;string,string&gt;), StatusCodes.Status200OK)]
    [ProducesResponseType(StatusCodes.Status400BadRequest)]
    [ProducesResponseType(StatusCodes.Status404NotFound)]
    [ProducesResponseType(StatusCodes.Status500InternalServerError)]
    [Route("/v1/kafka/deliver")]
    public async Task&lt;IActionResult&gt; DeliverMessage(string key, string value)
    {
        Devon4NetLogger.Debug("Executing DeliverMessage from controller KafkaController");
        var result = await MessageProducer.SendMessage(key, value).ConfigureAwait(false);
        return Ok(result);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example, in the previous piece of code, you can see how we are delivering a message to the Kafka server using a POST method in our API. This is done thanks to the <code>SendMessage</code> method.</p>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_consumer">Consumer</h5>
<div class="paragraph">
<p>The consumer is a little different, as you can see in the following piece of code, you will need to override the <code>HandleCommand</code> method. This will handle the process of consuming new messages to which the consumer is subscribed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public class MessageConsumerHandler : KafkaConsumerHandler&lt;string, string&gt;
{
    public MessageConsumerHandler(IServiceCollection services, IKakfkaHandler kafkaHandler, string consumerId, bool commit = false, int commitPeriod = 5) : base(services, kafkaHandler, consumerId, commit, commitPeriod)
    {
    }

    public override void HandleCommand(string key, string value)
    {
        Devon4NetLogger.Information($"Consumed message key: {key} | value: {value}");
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Similar to the producer, the Consumer also needs to be related to a configuration via the <code>Id</code> as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">builder.Services.AddKafkaConsumer&lt;MessageConsumerHandler&gt;("Consumer1");</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-protocol-buffers">How to: Protocol buffers</h4>
<div class="paragraph">
<p>Protocol buffers are Google’s language-neutral, platform-neutral, extensible mechanism for serializing structured data. You can see it as a JSON or a XML file, but smaller, faster and with an easier syntax.</p>
</div>
<div class="paragraph">
<p>Protocol buffers are ideal for any situation in which you need to serialize data in a neutral language. Very useful when defining communications such as gRPC protocol.</p>
</div>
<div class="paragraph">
<p>In this guide you will learn how to create a protocol buffer using <code>proto3</code> language.</p>
</div>
<div class="paragraph">
<p>The <code>.proto</code> file starts with a package declaration, which helps to prevent naming conflicts between different projects.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-proto3" data-lang="proto3">syntax = "proto3";

option csharp_namespace = "Devon4Net.Application.GrpcClient.Protos";

package greet;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Also for C#, you can specify the <code>csharp_namespace</code> option. If it wasn’t specified, the generated classes would be placed in a namespace matching the package name.</p>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_messages">Messages</h5>
<div class="paragraph">
<p>You also have message definitions, which is an aggregate containing a set of typed fields:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-proto3" data-lang="proto3">message Person {
  string name = 1;
  int32 id = 2;
  string email = 3;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The previous example defines a type Person with <code>name</code>, <code>id</code> and <code>email</code>. Each field needs a unique identifier, which is the number shown after the <code>=</code>. The data types are the standard ones including <code>bool</code>, <code>int32</code>, <code>float</code>, <code>double</code>, and <code>string</code>.</p>
</div>
<div class="paragraph">
<p>Let’s say that this Person can have many phone numbers, we could do something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-proto3" data-lang="proto3">message Person {
  string name = 1;
  int32 id = 2;
  string email = 3;
  repeated PhoneNumber phoneNumbers = 4;
}

message PhoneNumber {
  string number = 1;
  PhoneType type = 2;
}

enum PhoneType {
  MOBILE = 0;
  HOME = 1;
  WORK = 2;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, if a field is <code>repeated</code>, the field may be repeated any number of times, including 0. You can also define <code>enum</code> types if you want one of your fields to have one of a predefined list of values.</p>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_services">Services</h5>
<div class="paragraph">
<p>If you want to use your message types with an RPC system, you may specify an RPC service interface in a.proto file, and the protocol buffer compiler will create code and stubs in your preferred language.</p>
</div>
<div class="paragraph">
<p>For example you could define the following contract:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-proto3" data-lang="proto3">service SearchService {
  rpc Search(SearchRequest) returns (SearchResponse);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case we will have a <code>SearchService</code> class with a <code>Search</code> method that accepts a <code>SearchRequest</code> and returns a <code>SearchResponse</code>. Both (SearchRequest and SearchResponse) need to be mapped to a message.</p>
</div>
<div class="paragraph">
<p>The following example shows the complete <code>.proto</code> file used in the devon gRPC templates.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-proto3" data-lang="proto3">syntax = "proto3";

option csharp_namespace = "Devon4Net.Application.GrpcClient.Protos";

package greet;

// The greeting service definition.
service Greeter {
  // Sends a greeting
  rpc SayHello (HelloRequest) returns (HelloReply);
}

// The request message containing the user's name.
message HelloRequest {
  string name = 1;
}

// The response message containing the greetings.
message HelloReply {
  string message = 1;
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Please revise the template documentation and the component documentation to learn more about gRPC
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_howto.asciidoc_references_19">References</h5>
<div class="ulist">
<ul>
<li>
<p><a href="https://developers.google.com/protocol-buffers">Protocol Buffers - Google Docs</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-aws-lambda-function">How to: AWS Lambda Function</h4>
<div class="paragraph">
<p>In this part of the document you are going to learn how to develop and deploy AWS Lambda functions using devon4net.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
We will make use of the devon4net AWS template. So please make sure you have read its documentation to know where everything is placed.
</td>
</tr>
</tbody></table>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_what-is-a-lambda-function">What is a Lambda Function?</h5>
<div class="paragraph">
<p>A Lambda Function is a function or piece of code that runs in AWS without having to configure or manage a server. You can setup your code and deploy it to the AWS Lambda Service and can trigger and be triggered from other AWS Services.</p>
</div>
<div class="paragraph">
<p>It supports numerous programming languages ​​among which is .NET.</p>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_howto.asciidoc_install-the-aws-template-and-visual-studio-aws-tools">Install the AWS template and Visual Studio AWS tools</h5>
<div class="paragraph">
<p>In devon4Net you have some AWS templates available, to install them you can run the following command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">dotnet new --install Devon4Net.AWS.Template</code></pre>
</div>
</div>
<div class="paragraph">
<p>After this you will be able to create a project using the template provided by devon4net that include the components you need to start developing your first lambda function.</p>
</div>
<div class="paragraph">
<p>You will also need to install the AWS tools for Visual Studio. Run the following command to install the tools:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">dotnet tool install -g Amazon.Lambda.Tools</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or check if a new version is available in case you have already installed it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">dotnet tool update -g Amazon.Lambda.Tools</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_howto.asciidoc_create-a-project-using-the-template">Create a project using the template</h5>
<div class="paragraph">
<p>Now that everything is installed you can start by creating your project using the template, for that:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open Visual Studio 2022 and select create a new project.</p>
</li>
<li>
<p>Look for the devon4net AWS Template, select it and click next.</p>
<div class="imageblock">
<div class="content">
<img src="images/aws_template_1.png" alt="aws template 1">
</div>
<div class="title">Figure 42. Create a new AWS project using devon4net</div>
</div>
</li>
<li>
<p>Choose a name and project location and create it.</p>
<div class="imageblock">
<div class="content">
<img src="images/aws_template_2.png" alt="aws template 2">
</div>
<div class="title">Figure 43. Create a new AWS project using devon4net</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>This three steps will create the project where we will develop our function. For this tutorial, we will focus in the Lambda part of the template. That means, that we will only be using the <code>Devon4Net.Application.Lambda</code> project present in the template:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/aws_template_lambda.png" alt="aws template lambda">
</div>
<div class="title">Figure 44. Devon4Net.Application.Lambda file structure</div>
</div>
<div class="paragraph">
<p>As you can see in the screenshot above, you already have some example functions that are already working:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>SnsManagement</code>: Example with Amazon Simple Notification Service (SNS)</p>
</li>
<li>
<p><code>SqsManagement</code>: Example with Amazon Simple Queue Service (SQS)</p>
</li>
<li>
<p><code>StringManagement</code>: Example processing some operations over strings</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each directory has the following subdirectories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Handlers: Implementation of the functions.</p>
</li>
<li>
<p>Functions: Function definition for the services.</p>
</li>
<li>
<p>Dto: Objects used to input and output the data in the functions.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you want to learn more about what this part of the template includes you can read the Template Documentation.
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_develop-your-first-function">Develop your first function</h5>
<div class="paragraph">
<p>We will follow the same file structure than the examples that are already in the template. For the example we will create a Calculator that will do a mathematical division of two numbers, <strong>dividend</strong> and <strong>divisor</strong>; and will produce two other numbers, <strong>quotient</strong> and <strong>remainder</strong>.</p>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_howto.asciidoc_step-1---create-input-and-output-class">Step 1 - Create Input and output class</h6>
<div class="paragraph">
<p>As the example says, we will need to input dividend and divisor, and output quotient and remainder, so lets create <code>CalculatorInputDto</code> and <code>CalculatorOutput</code> objects in <code>CalculatorManagement/Dto</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public class CalculatorInputDto
{
    public int Dividend { get; set; }
    public int Divisor { get; set; }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public class CalculatorOutputDto
{
    public int Quotient { get; set; }
    public int Remainder { get; set; }
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_howto.asciidoc_step-2---create-function-handler">Step 2 - Create Function Handler</h6>
<div class="paragraph">
<p>To create the function handler you will need to implement the <code>FunctionHandler</code> method available thanks to <code>ILambdaEventHandler&lt;TInput, TOutput&gt;</code> interface from <code>Devon4Net.Infrastructure.AWS.Lambda</code> component.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
To learn more about it, please read the component documentation.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>This method will contain all the logic necessary that will be aplied to <code>TInput</code> to produce <code>TOutput</code>, being <code>CalculatorInputDto</code> and <code>CalculatorOutputDto</code> respectively.</p>
</div>
<div class="paragraph">
<p>To follow the structure it will be placed in <code>CalculatorManagement/Handlers</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public class CalculatorFunctionEventHandler : ILambdaEventHandler&lt;CalculatorInputDto, CalculatorOutputDto&gt;
{
    public Task&lt;CalculatorOutputDto&gt; FunctionHandler(CalculatorInputDto calculatorInput, ILambdaContext context)
    {
        CalculatorOutputDto output = new()
        {
            Quotient = calculatorInput.Dividend/calculatorInput.Divisor,
            Remainder = calculatorInput.Dividend%calculatorInput.Divisor
        };
        return Task.FromResult(output);
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_howto.asciidoc_step-3---add-function-to-services">Step 3 - Add Function to Services</h6>
<div class="paragraph">
<p>Now we need to create our Function class that will inherit from <code>LambdaFunction&lt;TInput, TOutput&gt;</code> also available thanks to the <code>Devon4Net.Infrastructure.AWS.Lambda</code> component.</p>
</div>
<div class="paragraph">
<p>And we will also need to implement the abstract method <code>ConfigureServices</code> as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c#" data-lang="c#">public class CalculatorFunction : LambdaFunction&lt;CalculatorInputDto, CalculatorOutputDto&gt;
{
    protected override void ConfigureServices(IServiceCollection services)
    {
        services
            .AddTransient&lt;ILambdaEventHandler&lt;CalculatorInputDto, CalculatorOutputDto&gt;, CalculatorFunctionEventHandler&gt;();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It will be placed in <code>CalculatorManagement/Functions</code> to follow the same structure.</p>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_howto.asciidoc_step-4---configure-it-in-serverless.template">Step 4 - Configure it in <code>serverless.template</code></h6>
<div class="paragraph">
<p>After the previous three steps we will have something like this:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/aws_template_calculator.png" alt="aws template calculator">
</div>
<div class="title">Figure 45. Calculator function file structure</div>
</div>
<div class="paragraph">
<p>Now we need to configure it so that the function is interpreted by AWS Lambda service as a Lambda function. For that we have a template defined as <code>serverless.template</code>.
In that file we will find the configuration for all the functions, where we will need to add the following configuration for the <code>CalculatorManagementFunction</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"CalculatorManagementFunction": {
  "Type": "AWS::Serverless::Function",
  "Properties": {
    "Handler": "Devon4Net.Application.Lambda::Devon4Net.Application.Lambda.business.CalculatorManagement.Functions.CalculatorFunction::FunctionHandler",
    "Runtime": "dotnetcore6.0",
    "CodeUri": "",
    "MemorySize": 512,
    "Timeout": 30,
    "Role": null,
    "Policies": [
      "AWSLambdaFullAccess",
      "AmazonSSMReadOnlyAccess",
      "AWSLambdaVPCAccessExecutionRole"
    ],
    "Environment": {
      "Variables": {}
    },
    "Events": {
      "ProxyResource": {
        "Type": "Api",
        "Properties": {
          "Path": "/{proxy+}",
          "Method": "ANY"
        }
      },
      "RootResource": {
        "Type": "Api",
        "Properties": {
          "Path": "/",
          "Method": "ANY"
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Before trying everything, as we are not using neither AWS Secrets Manager nor AWS Parameter Store, navigate to <code>appsettings.json</code> and make sure the following variables are set to <code>false</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "AWS": {
    "UseSecrets": false,
    "UseParameterStore": false,
    "Credentials": {
      "Profile": "",
      "Region": "eu-west-1",
      "AccessKeyId": "",
      "SecretAccessKey": ""
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_howto.asciidoc_step-5---try-it">Step 5 - Try it</h6>
<div class="paragraph">
<p>To try that everything works fine in our local we will be using <strong>Mock Lambda Test Tool 6.0</strong> from the AWS toolkit that we installed earlier.</p>
</div>
<div class="paragraph">
<p>For that, right click in the project (1) and select it as startup project (2). Then execute it by pressing the green button which says <code>Mock Lambda Test Tool 6.0</code> (3).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/aws_template_execute.png" alt="aws template execute">
</div>
<div class="title">Figure 46. Execute the lambda function</div>
</div>
<div class="paragraph">
<p>Now navigate to <code><a href="http://localhost:5050/" class="bare">http://localhost:5050/</a></code> using your favorite web browser (1) and select the CalculatorFunction in the UI (2). You can put your desired numbers in the form of a JSON in the box (3), press Execute (4) and check the results (5).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/aws_template_test.png" alt="aws template test">
</div>
<div class="title">Figure 47. Try it</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_howto.asciidoc_references_22">References</h5>
<div class="ulist">
<ul>
<li>
<p><a href="https://aws.amazon.com/lambda/">AWS Lambda</a></p>
</li>
<li>
<p><a href="https://aws.amazon.com/sqs/">Amazon Simple Queue Service (SQS)</a></p>
</li>
<li>
<p><a href="https://aws.amazon.com/sns/">Amazon Simple Notification Service (SNS)</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-guide_devon4net.wiki_howto.asciidoc_how-to-aws-serverless">How to: AWS Serverless</h4>
<div class="paragraph">
<p>In this section, you will learn how to launch a AWS WebAPI serverless using devon4net.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
We will make use of the devon4net AWS template. So please make sure you have read its documentation to know where everything is placed.
</td>
</tr>
</tbody></table>
</div>
<div class="sect4">
<h5 id="devonfw-guide_devon4net.wiki_howto.asciidoc_what-is-a-serverless-architecture">What is a serverless architecture?</h5>
<div class="paragraph">
<p>A serverless architecture is a way to build and run applications and services without having to manage infrastructure. Your application still runs on servers, but all the server management is done by AWS.</p>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_howto.asciidoc_install-the-aws-template-and-visual-studio-aws-tools_23">Install the AWS template and Visual Studio AWS tools</h5>
<div class="paragraph">
<p>In devon4Net you have some AWS templates available, to install them you can run the following command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">dotnet new --install Devon4Net.AWS.Template</code></pre>
</div>
</div>
<div class="paragraph">
<p>Following that, you will be able to build a project using the devon4net template that includes the components you need to begin building your first AWS serverless WebAPI.</p>
</div>
</div>
<div class="sect4">
<h5 id="asciidoc_devonfw-guide_devon4net.wiki_howto.asciidoc_create-a-project-using-the-template_24">Create a project using the template</h5>
<div class="paragraph">
<p>Now that everything is in place, you may begin by creating your project using the template:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open Visual Studio 2022 and select create a new project.</p>
</li>
<li>
<p>Look for the devon4net AWS Template, select it and click next.</p>
<div class="imageblock">
<div class="content">
<img src="images/aws_template_1.png" alt="aws template 1">
</div>
<div class="title">Figure 48. Create a new AWS project using devon4net</div>
</div>
</li>
<li>
<p>Choose a name and project location and create it.</p>
<div class="imageblock">
<div class="content">
<img src="images/aws_template_3.png" alt="aws template 3">
</div>
<div class="title">Figure 49. Create a new AWS project using devon4net</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>These three procedures will result in the creation of the project in which we will develop our serverless WebAPI.
For that, we will just use the project 'Devon4Net.Application.WebAPI.AwsServerless' from the template:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/WebAPI-AwsServerless-structure.png" alt="WebAPI AwsServerless structure">
</div>
<div class="title">Figure 50. Devon4Net.Application.WebAPI.AwsServerless file structure</div>
</div>
<div class="paragraph">
<p>[[devonfw-guide_devon4net.wiki_howto.asciidoc_step-1---configure-it-in-appsettings.{environment}.json]]
==== Step 1 - Configure it in <code>appsettings.{environment}.json</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
    "AWS": {
    "EnableAws": true,
    "UseSecrets": true,
    "UseParameterStore": true,
    "Credentials": {
      "Profile": "default",
      "Region": "eu-west-1",
      "AccessKeyId": "",
      "SecretAccessKey": ""
    },
    "Cognito": {
      "IdentityPools": [
        {
          "IdentityPoolId": "",
          "IdentityPoolName": "",
          "ClientId": ""
        }
      ]
    },
    "SqSQueueList": [
      {
        "QueueName": "", // Mandatory. Put the name of the queue here
        "Url": "", //optional. If it is not present, it will be requested to AWS
        "UseFifo": false,
        "MaximumMessageSize": 256,
        "NumberOfThreads": 2,
        "DelaySeconds": 0,
        "ReceiveMessageWaitTimeSeconds": 0,
        "MaxNumberOfMessagesToRetrievePerCall": 1,
        "RedrivePolicy": {
          "MaxReceiveCount": 1,
          "RedrivePolicy": {
            "MaxReceiveCount": 1,
            "DeadLetterQueueUrl": ""
          }
        }
      }
    ]
  }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you want to learn more about these parameters you can check the template or the component documentation.
</td>
</tr>
</tbody></table>
</div>
<div class="sect5">
<h6 id="devonfw-guide_devon4net.wiki_howto.asciidoc_step-2---set-up-as-startup-project">Step 2 - Set up as startup project</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Right click in the <code>Devon4Net.Application.WebAPI.AwsServerless</code>.</p>
</li>
<li>
<p>Select the "Set as Startup Project" option.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/aws_template_startup.png" alt="aws template startup">
</div>
<div class="title">Figure 51. Setting a project as Startup project</div>
</div>
</div>
<div class="sect5">
<h6 id="asciidoc_devonfw-guide_devon4net.wiki_howto.asciidoc_step-3---run-it_25">Step 3 - Run it</h6>
<div class="paragraph">
<p>Run the project and now you can start to develop your serverless WebAPI.</p>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph nav-footer">
<p>↑&nbsp;Up:&nbsp;<a href="devonfw-guide_devon4net.wiki_master-devon4net.asciidoc_how-to-section.html">How To section</a>&nbsp;| ⌂&nbsp;Home:&nbsp;<a href="master.html">devonfw guide</a>&nbsp;| Next:&nbsp;<a href="devonfw-guide_devon4net.wiki_master-devon4net.asciidoc_cobigen-guide.html">Cobigen guide</a>&nbsp;→</p>
</div>
</div>
<div id="footer" class="footer">
<div class="openblock footerLinks">
<div class="content">
<div class="dlist linklist">
<dl>
<dt class="hdlist1">About</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="/website/pages/welcome/welcome.html">About devonfw</a></p>
</li>
<li>
<p><a href="/website/pages/docs/devonfw-guide_getting-started.wiki_introduction-why-should-i-use-devonfw.asciidoc_features.html">Features</a></p>
</li>
<li>
<p><a href="/website/pages/docs/devonfw-guide_devon4j.wiki_architecture.asciidoc.html#devonfw-guide_devon4j.wiki_architecture.asciidoc_technology-stack">Technology Stack</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="dlist linklist">
<dl>
<dt class="hdlist1">Explore</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="/website/pages/docs/devonfw-guide_getting-started.wiki_getting-started.asciidoc.html">Getting started</a></p>
</li>
<li>
<p><a href="/website/pages/docs/devonfw-guide_devon4j.wiki_architecture.asciidoc.html">Architecture</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="dlist linklist">
<dl>
<dt class="hdlist1">Docs</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="/website/pages/docs/devonfw-guide_ide.wiki_devonfw-ide-introduction.asciidoc.html">User guide</a></p>
</li>
<li>
<p><a href="/website/pages/docs/devonfw-guide_general_master-release-notes.asciidoc.html">Releases information</a></p>
</li>
<li>
<p><a href="/website/pages/docs/master.html">Wiki</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="dlist linklist">
<dl>
<dt class="hdlist1">Community</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/orgs/devonfw/people">Contributors</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/devonfw.github.io/blob/develop/README.asciidoc">Website Contribution</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="ulist footerFooter">
<ul>
<li>
<p><a href="https://devonfw.com/website/pages/docs/devonfw-guide_ide.wiki_LICENSE.asciidoc.html">Terms of Use</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw">Support</a></p>
</li>
</ul>
</div>
</div>
    <script>
      let bb = document.getElementById('menu-button');
      bb.addEventListener('click', function() {
        document.querySelector('.website-navbar ul').classList.toggle('visible');
        console.log(document.querySelector('.website-navbar ul'))
      })
    </script>
    <script type="module">
      import { EditLinksModule } from '/website/shared/editlinks.js';

      let alwaysVisible = true;
      if(document.location.pathname.endsWith("pages/welcome/welcome.html")) {
        alwaysVisible = false;
      }
      EditLinksModule.addEditLinks(alwaysVisible);
    </script>
    <script src="/website/assets/scripts/popper.min.js"></script>
    <script src="/website/assets/scripts/bootstrap.min.js"></script>
<div class="footnote"><sub>

Last updated 2022-09-09 09:10:12 UTC
</sub></div>


<link rel="stylesheet" type="text/css" href="https://cginternal.devonfw.com/websitesnippets/main.css">
<script async="" src="https://cginternal.devonfw.com/websitesnippets/main.js"></script>
<script>
  if(!document.location.pathname.endsWith("pages/welcome/welcome.html")) {
    anchors.options.visible = 'always';
  }
  anchors.add();
</script>
<script>
  var internalUrls = ["https://cginternal.devonfw.com/websitesnippets/"];
  $(".internal").each(function(){
    internalUrls.forEach((internalUrl, index) => {
      $.ajax({url: internalUrl + $(this).text() + "/index.html" })
      .then(r => {
        var leftDiv = $('<div class="info"><span class="infoText">Internal</span><img class="infoImage" src="' + internalUrl + 'logo.png"/></div>');
        var rightFirstDiv = $('<div class="message">This is only visible inside of the corporate network.</div>');
        var rightLastDiv = $('<div class="content"></div>');
        rightLastDiv.html(r);
        var rightDiv = $('<div class="right"></div>');
        rightDiv.append(rightFirstDiv);
        rightDiv.append(rightLastDiv);
        $(this).html(leftDiv);
        $(this).append(rightDiv);
        $(this).addClass("internal-active");
        $(this).removeClass("internal");
      })
    });
	});
</script>
<script>
      let cookieName = 'cookie_consent';
      let expiryTime = new Date(2037, 11, 21);
      let today = new Date();
      let cookieConsentDeclinedDate = localStorage.getItem("cookie_consent_declined");
      let dateDiffHours = 0;
      let cookieConsentHtml = `
      <div id="cookie-consent">
        <p>
          We use cookies to perform analytics and enhance user experience. Do you accept to the use of cookies?
        </p>
        <p class="cookie-consent-buttons">
          <a id="decline-cookie-btn" class="btn white-button" href="javascript:void(0)">Decline</a>
          <a id="accept-cookie-btn" class="btn blue-button" href="javascript:void(0)">Accept</a>
        </p>
      </div>
      `;
      dateDiffHours = cookieConsentDeclinedDate ? Math.abs(cookieConsentDeclinedDate - today) / 36e5 : 0;
      if (document.cookie.indexOf(cookieName) < 0) {
        if (cookieConsentDeclinedDate) {
          if (dateDiffHours > 24) {
            $("body").append(cookieConsentHtml);
          }
        } else {
          $("body").append(cookieConsentHtml);
        }
      }
      $("#accept-cookie-btn").click(function() {
        document.cookie = `${cookieName}=accept;expires=${expiryTime};path=/`;
        localStorage.removeItem("cookie_consent_declined");
        consentGranted();
        $("#cookie-consent").hide();
      });
      $("#decline-cookie-btn").click(function() {
        localStorage.setItem("cookie_consent_declined", today);
        $("#cookie-consent").hide();
      });
</script>

</body></html>