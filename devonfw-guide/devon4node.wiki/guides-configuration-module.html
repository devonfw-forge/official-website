<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=">
<meta name="generator" content="Asciidoctor 1.5.8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- ******** SOCIAL MEDIA META ********** -->

<meta name="title" property="og:title" content="devonfw website">
<meta property="og:type" content="website">
<meta name="image" property="og:image" content="https://devonfw.com/images/devonfwwebsite.png">
<meta name="description" property="og:description" content="devonfw is the standard open source software development platform; Serving the full Software Delivery Life Cycle.">
<meta property="og:url" content="https://devonfw.com/index.html">

<meta name="twitter:title" content="devonfw website">
<meta name="twitter:description" content="devonfw is the standard open source software development platform; Serving the full Software Delivery Life Cycle.">
<meta name="twitter:image" content="https://devonfw.com/images/devonfwwebsite.png">
<meta name="twitter:card" content="summary_large_image">

<!-- ************************************* -->


<title>Configuration Module</title>
<!-- devonfw website stylesheet -->
<link rel="stylesheet" type="text/css" href="/devonfw.css">
<!-- Lunr -->
<script src="/website/assets/scripts/lunr.min.js"></script>
<!-- JQuery -->
<script src="/website/assets/scripts/jquery.min.js"></script>
<link rel="stylesheet" href="/website/assets/styles/font-awesome.min.css">
<link rel="stylesheet" href="/website/assets/styles/googlecode.min.css">
<script src="/website/assets/scripts/highlight.min.js"></script>
<script src="/website/assets/scripts/common.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
<link rel="stylesheet" href="/website/assets/styles/bootstrap.min.css">

<script src="/website/assets/scripts/anchor.min.js"></script>

<script src="/website/components/header/search-engine/bundle.js"></script>

<script src="/website/shared/rightmenu.js"></script>

<!-- ************** Google analytics ************ -->
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

gtag('consent', 'default', {
  'analytics_storage': 'denied'
});
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-151636804-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-151636804-1');
</script>
<script>
  function consentGranted() {
    gtag('consent', 'update', {
      'analytics_storage': 'granted'
    });
  }
</script>

<!-- ******************************************** -->


</head>
<body class="article">
<div id="website-navbar" class="website-navbar">
<button id="menu-button" class="menu-button">
  <img src="/images/menu-button.svg" width="32px" height="32px" alt=""/>
</button>

<ul>
<li>
<p><span class="image"><a class="image" href="https://devonfw.com/"><img alt="logo" src="/images/Logo_devonfw.svg"></a></span></p>
</li>
<li>
<p><a href="https://devonfw.com/website/pages/learning/">Tutorials</a></p>
</li>
<li>
<p><a href="/website/pages/solutions/index.html">Solutions</a></p>
</li>
<li>
<p><a href="/website/pages/docs/master.html">Docs</a></p>
</li>
</ul>

<form class="form-inline">
  <div class="search-bar">
    <input
      id="search-field"
      type="search"
      class="form-control mr-sm-2"
      placeholder="Search by keyword(s)..."
      aria-label="Search"
      style="height: auto;"
      autocomplete="off"/>
    <div class="sb-res-pos px-4">
      <div id="click-outside" class="click-outside z-50 hidden"></div>
      <div class="col rounded px-0 border z-100 bg-white hidden search-bar-results" id="search-results-box">
      </div>
    </div>
  </div>
</form>
<a class="navbar-github text-white" href="https://github.com/devonfw/">
  <img src="/images/github-mark.png" width=auto height=auto alt="">
</a></div>
<div id="sidebar" class="wiki-sidebar"></div>

<div id="content" class="mt-4 mt-sm-5">
<div class="toc2">
<div class="title">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#devonfw-guide_devon4node.wiki_guides-configuration-module.asciidoc">Configuration Module</a>
<ul class="sectlevel1">
<li><a href="#devonfw-guide_devon4node.wiki_guides-configuration-module.asciidoc_include-configuration-module-in-your-project">Include Configuration Module in your project</a></li>
<li><a href="#devonfw-guide_devon4node.wiki_guides-configuration-module.asciidoc_configure-the-configmodule">Configure the <code>ConfigModule</code></a></li>
<li><a href="#devonfw-guide_devon4node.wiki_guides-configuration-module.asciidoc_use-the-configuration-service">Use the configuration service</a></li>
<li><a href="#devonfw-guide_devon4node.wiki_guides-configuration-module.asciidoc_choose-an-environment-file">Choose an environment file</a></li>
<li><a href="#devonfw-guide_devon4node.wiki_guides-configuration-module.asciidoc_override-configuration-properties">Override configuration properties</a></li>
<li><a href="#devonfw-guide_devon4node.wiki_guides-configuration-module.asciidoc_add-a-configuration-property">Add a configuration property</a></li>
<li><a href="#devonfw-guide_devon4node.wiki_guides-configuration-module.asciidoc_validate-your-configuration">Validate your configuration</a></li>
</ul>
</li>
</ul>
<h1 id="devonfw-guide_devon4node.wiki_guides-configuration-module.asciidoc" class="sect0">Configuration Module</h1>
<div class="paragraph">
<p>Devon4node configuration module allows you to manage the multiple configurations that your application can have. Its a built in package that you can install in your project: <code>@devon4node/config</code>.</p>
</div>
<div class="paragraph">
<p>The main difference with other configuration modules is that <code>@devon4node/config</code> stores all configuration in typescript files. With that you will be able to configure different values depending on the environment, but also you can configure functions, arrays, objects and so on. As some configurations must secret and that configuration will be known only at runtime, it also provides a mechanism to override your configuration by using environment variables.</p>
</div>
<div class="paragraph">
<p>With <code>@devon4node/config</code> you will be able to validate your configuration based on class-validator.</p>
</div>
<div class="sect1">
<h2 id="devonfw-guide_devon4node.wiki_guides-configuration-module.asciidoc_include-configuration-module-in-your-project">Include Configuration Module in your project</h2>
<div class="sectionbody">
<div class="paragraph">
<p>devon4node provides a way to generate a configuration module inside your application. To generate it you only need to execute the command <code>nest g -c @devon4node/schematics config-module</code>. This command will generate inside your application:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Imports configuration module in the core module.</p>
</li>
<li>
<p>config folder where all environment configuration are stored.</p>
<div class="ulist">
<ul>
<li>
<p>default configuration: configuration for your local development environment.</p>
</li>
<li>
<p>develop environment configuration for the develop environment.</p>
</li>
<li>
<p>UAT environment configuration for the UAT environment.</p>
</li>
<li>
<p>production environment configuration for the production environment.</p>
</li>
<li>
<p>test environment configuration used by test.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title=""></i>
</td>
<td class="content">
some code generators will add some properties to this module, so, be sure that the config module is the first module that you generate in your application.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="devonfw-guide_devon4node.wiki_guides-configuration-module.asciidoc_configure-the-configmodule">Configure the <code>ConfigModule</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you register the <code>ConfigModule</code> in your application you can configure it. As the <code>ConfigModule</code> should be a module that you will need in all modules in your application, it is registered by default in the <code>CoreModule</code> (remember that <code>CoreModule</code> is global).</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="typescript language-typescript">@Global()
@Module({
  imports: [
    ConfigModule.register({
      configDir: './dist/config',
      configType: Config,
    }),
  ],
  controllers: [],
  providers: [],
  exports: [ConfigModule],
})
export class CoreModule {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The values that you can provide to the <code>ConfigModule</code> are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>configDir</code>: path to the directory where all config files are stored. This is the path to the compiled JavaScript files, not the path that include the TypeScript files. The default value is: './dist/config'</p>
</li>
<li>
<p><code>configType</code>: the type of the config files. You can use the default type generated at <strong>shared/config/config.model.ts</strong> or generate you own type. In this type is where you can define the validation by using the <strong>class-validator</strong> decorators.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="devonfw-guide_devon4node.wiki_guides-configuration-module.asciidoc_use-the-configuration-service">Use the configuration service</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To use the configuration service, you only need to inject it as dependency. As configuration module is defined in the core module, it will be available everywhere in your application. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="typescript language-typescript">export class MyProvider {
  constructor(public readonly configService: ConfigService&lt;Config&gt;) {}

  myMethod() {
    return this.confiService.values.isDev;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The generic type is required in order to provide the <code>intellisense</code> to <code>configService.values</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="devonfw-guide_devon4node.wiki_guides-configuration-module.asciidoc_choose-an-environment-file">Choose an environment file</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default, when you use the configuration service it will take the properties defined in the default.ts file. If you want to change the configuration file, you only need to set the NODE_ENV environment property with the name of the desired environment. Examples: in windows execute <code>set NODE_ENV=develop</code> before executing the application, in Linux execute <code>NODE_ENV=develop</code> before executing the application or <code>NODE_ENV=develop yarn start</code>.</p>
</div>
<div class="paragraph">
<p>In most scenarios, when you want to use a environment file you want to use the same values as the default.ts file and override some properties. For that, what @devon4node/config do is a merge of the default configuration file with the selected configuration file, so you don&#8217;t need to repeat all configuration values in all configuration files, you need to put only the values that are different to the default one.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="devonfw-guide_devon4node.wiki_guides-configuration-module.asciidoc_override-configuration-properties">Override configuration properties</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sometimes, you want to keep some configuration property secure, and you do not want to publish it to the repository, or you want to reuse some configuration file but you need to change some properties. For those scenarios, you can override configuration properties by defining a environment variable. The pattern for the environment variables name is: the property name in upper case, if it is a nested object you must separate the properties with underscores (<code>_</code>). For example, if you want to override the property <code>host</code>, you can do: <code>export HOST="newhost"</code> (in windows: <code>set HOST="newhost"</code>). It also works with objects. For example, if you want to change the value of secret in the property <code>jwtConfig</code> for <a href="#devonfw-guide/devon4node.wiki_https://github.com/devonfw/devon4node/blob/develop/samples/employee/src/config/develop.ts">this example</a>, you can set a environment variable like this: <code>export JWTCONFIG_SECRET="newsecret"</code>. If you want to override <code>jwtConfig</code> totally (or partially) you can set a JSON string. It will take object and merge the <code>jwtConfig</code> property with the properties defined inside the environment variable. The other properties maintain their value. The behavior is the same for the nested objects. Example: JWTCONFIG='{"secret":"mysecret"}' will override the <code>jwtConfig</code>.secret value, but the other values will remain with the value defined at configuration file.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title=""></i>
</td>
<td class="content">
you can only override properties that exists in the config file. If you want to use a secret configuration that will be setted at runtime, first you must define it in the config file and set a fake value or just an empty string.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="devonfw-guide_devon4node.wiki_guides-configuration-module.asciidoc_add-a-configuration-property">Add a configuration property</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to add a new property to the configuration module, you need to follow some steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add the property to Config class at <code>src/app/shared/configuration/model/config/config.model.ts</code> file (or your custom Config class).</p>
</li>
<li>
<p>Add the validation decorators (only if you want to use the validation feature)</p>
</li>
<li>
<p>Add the property the config files inside the <code>src/config</code> folder. If you want to use the same value for all environments, just put the value inside default.ts file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p>We want to add the property <code>devonfwUrl</code> to our <code>ConfigService</code>, so:</p>
</div>
<div class="paragraph">
<p>We add the following code in Config class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="typescript language-typescript">@IsString()
@IsDefined()
devonfwUrl!: string;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, we add the definition the config files:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="typescript language-typescript">devonfwUrl: 'https://devonfw.com',</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="devonfw-guide_devon4node.wiki_guides-configuration-module.asciidoc_validate-your-configuration">Validate your configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to make you able to validate your configuration, this package includes a feature to do that by using the <code>class-decorator</code> package.</p>
</div>
<div class="paragraph">
<p>To configure your validations you only need to add the <code>class-validator</code> decorators to your Config class.</p>
</div>
<div class="paragraph">
<p>To enable the validation you only must set the <code>VALIDATE_CONFIG</code> environment variable to <code>true</code>.</p>
</div>
<div class="paragraph">
<p>When enable it will execute the config validation when the application starts. If the validation fail, the application will not start.</p>
</div>
</div>
</div>
</div>
<div id="footer" class="footer">
<div class="openblock footerLinks">
<div class="content">
<div class="dlist linklist">
<dl>
<dt class="hdlist1">About</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="/website/pages/welcome/welcome.html">About devonfw</a></p>
</li>
<li>
<p><a href="/website/pages/docs/devonfw-guide_getting-started.wiki_introduction-why-should-i-use-devonfw.asciidoc_features.html">Features</a></p>
</li>
<li>
<p><a href="/website/pages/docs/devonfw-guide_devon4j.wiki_architecture.asciidoc.html#devonfw-guide_devon4j.wiki_architecture.asciidoc_technology-stack">Technology Stack</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="dlist linklist">
<dl>
<dt class="hdlist1">Explore</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="/website/pages/docs/devonfw-guide_getting-started.wiki_getting-started.asciidoc.html">Getting started</a></p>
</li>
<li>
<p><a href="/website/pages/docs/devonfw-guide_devon4j.wiki_architecture.asciidoc.html">Architecture</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="dlist linklist">
<dl>
<dt class="hdlist1">Docs</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="/website/pages/docs/devonfw-guide_ide.wiki_devonfw-ide-introduction.asciidoc.html">User guide</a></p>
</li>
<li>
<p><a href="/website/pages/docs/devonfw-guide_general_master-release-notes.asciidoc.html">Releases information</a></p>
</li>
<li>
<p><a href="/website/pages/docs/master.html">Wiki</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="dlist linklist">
<dl>
<dt class="hdlist1">Community</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/orgs/devonfw/people">Contributors</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/devonfw.github.io/blob/develop/README.asciidoc">Website Contribution</a></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="ulist footerFooter">
<ul>
<li>
<p><a href="https://devonfw.com/website/pages/docs/devonfw-guide_ide.wiki_LICENSE.asciidoc.html">Terms of Use</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw">Support</a></p>
</li>
</ul>
</div>
</div>
    <script>
      let bb = document.getElementById('menu-button');
      bb.addEventListener('click', function() {
        document.querySelector('.website-navbar ul').classList.toggle('visible');
        console.log(document.querySelector('.website-navbar ul'))
      })
    </script>
    <script type="module">
      import { EditLinksModule } from '/website/shared/editlinks.js';

      let alwaysVisible = true;
      if(document.location.pathname.endsWith("pages/welcome/welcome.html")) {
        alwaysVisible = false;
      }
      EditLinksModule.addEditLinks(alwaysVisible);
    </script>
    <script src="/website/assets/scripts/popper.min.js"></script>
    <script src="/website/assets/scripts/bootstrap.min.js"></script>
<div class="footnote"><sub>

Last updated 2022-11-14 11:27:47 UTC
</sub></div>
</div>
</div>
<link rel="stylesheet" type="text/css" href="https://cginternal.devonfw.com/websitesnippets/main.css">
<script async src="https://cginternal.devonfw.com/websitesnippets/main.js"></script>
<script>
  if(!document.location.pathname.endsWith("pages/welcome/welcome.html")) {
    anchors.options.visible = 'always';
  }
  anchors.add();
</script>
<script>
  var internalUrls = ["https://cginternal.devonfw.com/websitesnippets/"];
  $(".internal").each(function(){
    internalUrls.forEach((internalUrl, index) => {
      $.ajax({url: internalUrl + $(this).text() + "/index.html" })
      .then(r => {
        var leftDiv = $('<div class="info"><span class="infoText">Internal</span><img class="infoImage" src="' + internalUrl + 'logo.png"/></div>');
        var rightFirstDiv = $('<div class="message">This is only visible inside of the corporate network.</div>');
        var rightLastDiv = $('<div class="content"></div>');
        rightLastDiv.html(r);
        var rightDiv = $('<div class="right"></div>');
        rightDiv.append(rightFirstDiv);
        rightDiv.append(rightLastDiv);
        $(this).html(leftDiv);
        $(this).append(rightDiv);
        $(this).addClass("internal-active");
        $(this).removeClass("internal");
      })
    });
	});
</script>
<script>
      let cookieName = 'cookie_consent';
      let expiryTime = new Date(2037, 11, 21);
      let today = new Date();
      let cookieConsentDeclinedDate = localStorage.getItem("cookie_consent_declined");
      let dateDiffHours = 0;
      let cookieConsentHtml = `
      <div id="cookie-consent">
        <p>
          We use cookies to perform analytics and enhance user experience. Do you accept to the use of cookies?
        </p>
        <p class="cookie-consent-buttons">
          <a id="decline-cookie-btn" class="btn white-button" href="javascript:void(0)">Decline</a>
          <a id="accept-cookie-btn" class="btn blue-button" href="javascript:void(0)">Accept</a>
        </p>
      </div>
      `;
      
      const parseCookie = str =>
        str
        .split(';')
        .map(v => v.split('='))
        .reduce((acc, v) => {
          acc[decodeURIComponent(v[0].trim())] = decodeURIComponent(v[1].trim());
          return acc;
        }, {});
      
      dateDiffHours = cookieConsentDeclinedDate ? Math.abs(cookieConsentDeclinedDate - today) / 36e5 : 0;
      if (document.cookie.indexOf(cookieName) < 0) {
        if (cookieConsentDeclinedDate) {
          if (dateDiffHours > 24) {
            $("body").append(cookieConsentHtml);
          }
        } else {
          $("body").append(cookieConsentHtml);
        }
      } else {
        cookies = parseCookie(document.cookie);
        if (cookies["cookie_consent"] == "accept") {
          consentGranted();
        }
      }
      
      $("#accept-cookie-btn").click(function() {
        document.cookie = `${cookieName}=accept;expires=${expiryTime};path=/`;
        localStorage.removeItem("cookie_consent_declined");
        consentGranted();
        $("#cookie-consent").hide();
      });
      $("#decline-cookie-btn").click(function() {
        localStorage.setItem("cookie_consent_declined", today);
        $("#cookie-consent").hide();
      });
</script>
</body>
</html>