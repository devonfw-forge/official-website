<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Testing e2e with Cypress :: devonfw</title>
    <link rel="canonical" href="https://devonfw.com/typescript/current/angular/guide-cypress.html">
    <meta name="generator" content="Antora 3.0.2">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://devonfw.com">devonfw</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
    <div class="navbar-end">
        <a class="navbar-item" href="/docs/java/current/">Java</a>
        <a class="navbar-item" href="/docs/typescript/current/">TypeScript</a>
        <a class="navbar-item" href="#">IDE</a>
        <a class="navbar-item" href="#">CI/CD</a>
        <a class="navbar-item" href="/website/pages/learning/">Tutorials</a>
        <a class="navbar-item" href="/website/pages/solutions/">Solutions</a>
        <a class="navbar-item" href="/website/pages/docs/master.html">Legacy Docs</a>
          <div class="navbar-item search hide-for-print">
            <div id="search-field" class="field">
              <input id="search-input" type="text" placeholder="Search the docs">
            </div>
          </div>
        <a class="navbar-github navbar-item" href="https://github.com/devonfw/"></a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="typescript" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Typescript</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../general/general.html">General</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../general/node_version_manager.html">nvm : Node Version Manager</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../general/package_managers.html">Package Managers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../general/package_manager_workflow.html">Package Managers Workflow</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../general/yarn_2.html">Yarn 2</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="angular-home.html">Angular</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="architecture-home.html">Architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ngrx-home.html">NgRx</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="guide-home.html">Guides</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nx-home.html">Nx</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Resources</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="guide-angular-libraries.html">Angular Libraries</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../ionic/ionic_home.html">Ionic</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ionic/ionic_getting_started.html">Ionic Getting Started</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ionic/ionic_to_android.html">Ionic to Android</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ionic/ionic_pwa.html">Ionic Progress Web Apps</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../nestjs/nestjs-home.html">NodeJS </a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Layers</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nestjs/layer-controller.html">Controller</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nestjs/layer-service.html">Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nestjs/layer-dataaccess.html">Data Access</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../nestjs/guide-nestjs-home.html">Guides</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">devon4node applications</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nestjs/samples.html">devon4node Samples</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nestjs/samples-step-by-step.html">devon4node Sample Step by Step</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Resources</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nestjs/guide-nestjs-libraries.html">NestJS Libraries</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Typescript</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../java/current/index.html">Java</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../java/current/index.html">1</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../index.html">Typescript</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Typescript</a></li>
    <li><a href="guide-cypress.html">Testing e2e with Cypress</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/devonfw/typescript/edit/main/modules/ROOT/pages/angular/guide-cypress.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Testing e2e with Cypress</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This guide will cover the basics of e2e testing using Cypress.</p>
</div>
<div class="paragraph">
<p>Cypress is a framework “all in one” that provides the necessary libraries to write specific e2e tests, without the need of Selenium.</p>
</div>
<div class="paragraph">
<p>Why Cypress?</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Uses JavaScript</p>
</li>
<li>
<p>It works directly with the browser so the compatibility with the front-end framework the project uses (in this case Angular) is not a problem.</p>
</li>
<li>
<p>Easy cross browser testing</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setup"><a class="anchor" href="#_setup"></a>Setup</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Install</strong>
First of all we need to install it, we can use <code>npm install</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ npm install -D cypress</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or we can install it with <code>yarn</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ yarn add -D cypress</code></pre>
</div>
</div>
<div class="paragraph">
<p>We need to run Cypress in order to get the folder tree downloaded, then create a <code>tsconfig.json</code> file inside <code>cypress folder</code> to add the typescript configuration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ . /node_modules/.bin/cypress open</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title"><code>tsconfig.json</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "compilerOptions": {
    "strict": true,
    "baseUrl": "../node_modules",
    "target": "es5",
    "lib": ["es5", "dom"],
    "types": ["cypress"]
  },
  "include": [
    "**/*.ts"
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong><code>BaseUrl</code></strong></p>
</div>
<div class="paragraph">
<p>Let&#8217;s setup the base URL so when we run the tests cypress will "navigate" to the right place, go to <code>cypress.json</code> on the root of the project.</p>
</div>
<div class="listingblock">
<div class="title">cypress.json</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "baseUrl": "http://localhost:4200"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_files_structure"><a class="anchor" href="#_files_structure"></a>Files / Structure</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">/cypress
  tsconfig.json
  /fixtures
    - example.json
  /integration
    - button.spec.ts
    - test.spec.ts
    /examples
  /plugins
    - index.js
  /support
    - commands.js
    - index.js</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>tsconfig.json</code> for typescript configuration.</p>
</div>
<div class="paragraph">
<p><code>fixtures</code> to store our mock data or files (images, mp3&#8230;&#8203;) to use on our tests.</p>
</div>
<div class="paragraph">
<p><code>integration</code> is where our tests go, by default it comes with an examples folder with tested samples.</p>
</div>
<div class="paragraph">
<p><code>plugins</code> is where the configuration files of the plugins go.</p>
</div>
<div class="paragraph">
<p><code>support</code> to add custom commands.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you are using Nx, it automatically generates a e2e cypress project for every project that you generate. So you already get the configuration files like <code>tsconfig.json</code> and <code>cypress.json</code> and also get the folder structure described above. This helps you focus more on writing your tests rather than setting up Cypress.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tests"><a class="anchor" href="#_tests"></a>Tests</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The structure is the same than Mocha.</p>
</div>
<div class="paragraph">
<p>First, we create a file, for example <code>form.spec.ts</code>, inside we define a context to group all our tests referred to the same subject.</p>
</div>
<div class="listingblock">
<div class="title">form.spec.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">context('Button page', () =&gt; {
  beforeEach(() =&gt; {
    cy.visit('/');
  });
  it('should have button',()=&gt;{
    cy.get('button').should('exist');
  });
  it('should contain PRESS',()=&gt;{
    cy.contains('button', 'PRESS');
  });
});</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title"><code>beforeEach</code></div>
<p>Visit '/' before every test.</p>
</div>
<div class="paragraph">
<div class="title">it</div>
<p>Inside we write the test.</p>
</div>
<div class="paragraph">
<p>The result:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/cypress/contextImg.jpg" alt="contextImg">
</div>
</div>
<div class="paragraph">
<p>For more info check <a href="https://docs.cypress.io/guides/core-concepts/writing-and-organizing-tests#Folder-Structure">Cypress documentation</a></p>
</div>
<div class="paragraph">
<p>On <a href="https://github.com/cypress-io/cypress-example-kitchensink">kitchensink</a>
you can find an official cypress demo with all the commands being used.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fixtures"><a class="anchor" href="#_fixtures"></a>Fixtures</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We use fixtures to mock data, it can be a json, an image, video&#8230;&#8203;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "name": "Dummy name",
  "phone": 999 99 99 99,
  "body": "Mock data"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can store multiple mocks on the same fixture file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "create":{"name": "e2etestBox"},
  "boxFruit":{
    "uuid":"3376339576e33dfb9145362426a33333",
    "name":"e2etestBox",
    "visibility":true,
    "items":[
      {"name":"apple","units":3},
      {"name":"kiwi","units":2},
    ]
  },
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To access data we don&#8217;t need to import any file, we just call <code>cy.fixture(filename)</code> inside the <code>**.spec.ts</code>. We can name it as we want.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">cy.fixture('box.json').as('fruitBox')</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>cy.fixture('box.json')</code> we get access to <code>box.json</code>
<code>.as(fruitBox)</code> is used to create an alias <code>(fruitBox)</code> to the fixture.</p>
</div>
<div class="paragraph">
<p>For more info check <a href="https://docs.cypress.io/api/commands/fixture.html#Syntax">Fixtures documentation</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_request_route"><a class="anchor" href="#_request_route"></a>Request / Route</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With cypress you can test your application with real data or with mocks.</p>
</div>
<div class="paragraph">
<p>Not using mocks guarantees that your tests are real e2e test but makes them vulnerable to external issues.
When you mock data you don&#8217;t know exactly if the data and the structure received from the backend is correct because you are forcing a mock on the response, but you can avoid external issues, run test faster and have better control on the structure and status.</p>
</div>
<div class="paragraph">
<p>To get more information go to <a href="https://docs.cypress.io/guides/guides/network-requests.html#Testing-Strategies">Testing Strategies</a></p>
</div>
<div class="sect2">
<h3 id="_route"><a class="anchor" href="#_route"></a>Route</h3>
<div class="paragraph">
<p>Cypress can intercept a XHR request and interact with it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">cy.server();
cy.route(
  'GET',
  '/apiUrl/list',
  [{"name":"apple", "units":3},{"name":"kiwi", "units":2}]
)</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>cy.server(options)</code> start a server to interact with the responses.</p>
</div>
<div class="ulist">
<div class="title"><code>cy.route(options)</code> intercepts a <code>XMLHttpRequests</code></div>
<ul>
<li>
<p>method <code>GET</code></p>
</li>
<li>
<p>URL <code>/apiUrl/list'</code></p>
</li>
<li>
<p>response <code>[{"name":"apple", "units":3},{"name":"kiwi", "units":2}]</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Waits</strong></p>
</div>
<div class="paragraph">
<p>Every cypress action has a default await time to avoid asynchronous issues, but this time can be short for some particular actions like API calls, for those cases we can use <code>cy.wait()</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">cy.server();
cy.route('/apiUrl/list').as('list');
cy.visit('/boxList');
cy.wait('@list');</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can find more information about <code>cy.wait()</code> <a href="https://docs.cypress.io/guides/guides/network-requests.html#Waiting">here</a></p>
</div>
<div class="paragraph">
<p>To mock data with fixtures:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">cy.fixture('box')
  .then(({boxFruit}) =&gt; {
    cy.route(
      'GET',
      '/apiUrl/list',
      boxFruit
    ).as('boxFruit');
    cy.get('#button').click();
    cy.wait('@journalsList');
    cy.get('#list').contains('apple');
  })</code></pre>
</div>
</div>
<div class="paragraph">
<p>We get <code>boxFruit</code> data from the box fixture and then we mock the API call with it so now the response of the call is <code>boxFruit</code> object.
When the button is clicked, it waits to receive the response of the call and then checks if the list contains one of the elements of the <code>fruitBox</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_request"><a class="anchor" href="#_request"></a>Request</h3>
<div class="paragraph">
<p>Make a HTTP request.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">cy.server();
cy.request('http://localhost:4200/')
  .its('body')
  .should('include', '&lt;h1&gt;Welcome to Devon4ngAngularElementsTest!&lt;/h1&gt;');</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we have <code>'http://localhost:4200'</code> as <code>baseUrl</code> on <code>cypress.json</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">cy.server();
cy.request('/')
  .its('body')
  .should('include', '&lt;h1&gt;Welcome to Devon4ngAngularElementsTest!&lt;/h1&gt;');
// Goes to http://localhost:4200/</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can add other options, like we can send the body of a form.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">cy.server();
cy.request({
  method: 'POST',
  url: '/send',
  form: true,
  body: {
    name: 'name task',
    description: 'description of the task'
  }
});</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_custom_commands"><a class="anchor" href="#_custom_commands"></a>Custom commands</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you see yourself writing the same test more than once (login is a common one), you can create a custom command to make things faster.</p>
</div>
<div class="paragraph">
<p><code>Cypress.Commands.add('name', ()&#8658;{})</code> to create the test.</p>
</div>
<div class="listingblock">
<div class="title">commands.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">Cypress.Commands.add('checkPlaceholder', (name) =&gt; {
  cy.get(`[name='${name}']`).click();
  cy.get('mat-form-field.mat-focused').should('exist');
});</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">index.ts</div>
<p>To use the commands we need to import the files on support/index.ts</p>
</div>
<div class="listingblock">
<div class="title">index.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import './commands'
import './file1'
import './folder/file2'</code></pre>
</div>
</div>
<div class="paragraph">
<p>index.ts is where all our custom commands files unite so Cypress knows where to find them.</p>
</div>
<div class="paragraph">
<p>And as we are using typescript we need to define a <code>namespace</code>, <code>interface</code> and define our function.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>index.d.ts</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">declare namespace Cypress {
  interface Chainable&lt;Subject&gt; {
    checkPlaceholder(name:string):Chainable&lt;void&gt;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Check <a href="https://docs.cypress.io/guides/tooling/typescript-support.html#Types-for-custom-commands">typescript custom commands</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cross_browser_testing"><a class="anchor" href="#_cross_browser_testing"></a>Cross browser testing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default the browser used by Cypress is Chrome, it has compatibility with it&#8217;s family browsers (including Microsoft Edge) and has beta support for Mozilla Firefox.</p>
</div>
<div class="paragraph">
<p>To change the browser on the panel we can do it by selecting the desired one on the browsers tab before running the spec file.</p>
</div>
<div class="paragraph">
<p><code>Cypress will detect and display, except electron, only the browsers that you have already installed on your machine.</code></p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/cypress/browserTab.jpg" alt="browserTab">
</div>
</div>
<div class="paragraph">
<p>Once the browser is selected, you can run your tests.</p>
</div>
<div class="paragraph">
<p>To change the browser on the automatic test run, you can add a flag on the node command</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cypress run --browser edge</code></pre>
</div>
</div>
<div class="paragraph">
<p>Only if we use the <code>cypress run</code> command.</p>
</div>
<div class="paragraph">
<p>Or we can change the script file.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>cypress/script.js</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const runTests= async ()=&gt;{
  ...
  const {totalFailed} = await cypress.run({browser:'edge'});
  ...
};</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://docs.cypress.io/guides/guides/cross-browser-testing.html#Continuous-Integration-Strategies">Cypress documentation</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_viewport"><a class="anchor" href="#_viewport"></a>Viewport</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Cypress allow us to create tests depending on the Viewport, so we can test responsiveness.</p>
</div>
<div class="paragraph">
<p>There are different ways to use it:</p>
</div>
<div class="paragraph">
<p>Inside a test case</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-Typescript hljs" data-lang="Typescript">it('should change title when viewport is less than 320px', ()=&gt;{
  cy.get('.title-l').should('be.visible');
  cy.get('.title-s').should('not.be.visible');
  cy.viewport(320, 480);
  cy.get('.title-l').should('not.be.visible');
  cy.get('.title-s').should('be.visible');
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>Passing the configuration as an option</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-Typescript hljs" data-lang="Typescript">describe('page display on medium size screen', {
  viewportHeight: 1000,
  viewportWidth: 400
}, () =&gt; {
  ...
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or we can set a default</p>
</div>
<div class="ulist">
<ul>
<li>
<p>cypress.json</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">...
{
 "viewportHeight": 1000
 "viewportWidth": 400,
}
...</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://docs.cypress.io/api/commands/viewport.html#Syntax">Viewport documentation</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_test_retries"><a class="anchor" href="#_test_retries"></a>Test retries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We can get false negatives intermittently due external issues that can affect our tests, because of that we can add, in the configuration, a retries entry so Cypress can run again a certain failed test the selected number of times to verify that the error is real.</p>
</div>
<div class="paragraph">
<p>We can set retries for run or open mode.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>cypress.json</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">...
"retries": {
    "runMode": 3,
    "openMode": 3
  }
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>The retries can be configured on the <code>cypress.json</code> or directly on a specific test.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-Typescript hljs" data-lang="Typescript">it('should get button', {
  retries: {
    runMode: 2,
    openMode: 2
  }
}, () =&gt; {
  ...
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>This retries those not shown on the test log.</p>
</div>
<div class="paragraph">
<p>Check more on <a href="https://docs.cypress.io/guides/guides/test-retries.html#Introduction">retries documentation</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reporter"><a class="anchor" href="#_reporter"></a>Reporter</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The tests results appear on the terminal, but to have a more friendly view we can add a reporter.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/cypress/reporter.jpg" alt="reporter">
</div>
</div>
<div class="sect2">
<h3 id="_mochawesome"><a class="anchor" href="#_mochawesome"></a>Mochawesome</h3>
<div class="paragraph">
<p>In this case we are going to use Mochawesome, initially its a Mocha reporter but as Cypress uses Mocha it works the same.</p>
</div>
<div class="paragraph">
<p><strong>Install</strong></p>
</div>
<div class="paragraph">
<p>npm</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">npm install --save-dev mochawesome</code></pre>
</div>
</div>
<div class="paragraph">
<p>yarn</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">yarn add -D mochawesome</code></pre>
</div>
</div>
<div class="paragraph">
<p>To run the reporter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cypress run --reporter mochawesome</code></pre>
</div>
</div>
<div class="paragraph">
<p>Mochawesome saves by default the generated files on <em>`./mochawesome-report/`</em> but we can add options to change this behavior.</p>
</div>
<div class="paragraph">
<p>Options can be passed to the reporter in two ways</p>
</div>
<div class="paragraph">
<p>Using a flag</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cypress run --reporter mochawesome --reporter-options reportDir=report</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or on <em>cypress.json</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "baseUrl": "http://localhost:4200",
  "reporter": "mochawesome",
  "reporterOptions": {
    "overwrite": false,
    "html": false,
    "json": true,
    "reportDir": "cypress/report"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>Overwrite:false</code> to not overwrite every **:spec.ts test report, we want them to create a merged version later.</p>
</div>
<div class="paragraph">
<p><code>reportDir</code> to set a custom directory.</p>
</div>
<div class="paragraph">
<p><code>html:false</code> because we don&#8217;t need it.</p>
</div>
<div class="paragraph">
<p><code>json:true</code> to save them on json.</p>
</div>
<div class="paragraph">
<p>Mochawesome only creates the html file of the last .spec.ts file that the tests run, that&#8217;s why we don&#8217;t generate html reports directly, in order to stack them all on the same final html we need to merge the reports.</p>
</div>
<div class="paragraph">
<p>Check the <a href="https://www.npmjs.com/package/mochawesome-report-generator">mochawesome documentation</a></p>
</div>
<div class="paragraph">
<p><strong><code>mochawesome-merge</code></strong></p>
</div>
<div class="paragraph">
<p><code>Mochawesome-merge</code> is a library that helps us to merge the different json.</p>
</div>
<div class="paragraph">
<p>npm</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">npm install --save-dev mochawesome-merge
npm install --save-dev mochawesome-report-generator</code></pre>
</div>
</div>
<div class="paragraph">
<p>yarn</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">yarn add -D mochawesome-merge
yarn add -D mochawesome-report-generator</code></pre>
</div>
</div>
<div class="paragraph">
<p>To merge the files we execute this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mochawesome-merge cypress/report/*.json &gt; cypress/reportFinal.json</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>reportFinal.json</code> is the result of this merge, whit that we have the data of all the spec files in one json.</p>
</div>
<div class="paragraph">
<p>We can also automate the test, merge and conversion to html using a script.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">const cypress = require('cypress');
const fse = require('fs-extra');
const { merge } = require('mochawesome-merge');
const generator = require('mochawesome-report-generator');
const runTests= async ()=&gt;{
  await fse.remove('mochawesome-report');
  await fse.remove('cypress/report');
  const {totalFailed} = await cypress.run();
  const reporterOptions = {
    files: ["cypress/report/*.json"]
  };
  await generateReport(reporterOptions);
  if(totalFailed !== 0){
    process.exit(2);
  };
};
const generateReport = (options)=&gt; {
  return merge(options).then((jsonReport)=&gt;{
    generator.create(jsonReport).then(()=&gt;{
      process.exit();
    });
  });
};
runTests();</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>fse.remove()</code> to remove older reports data.</p>
</div>
<div class="paragraph">
<p><code>cypress.run()</code> to run the tests.</p>
</div>
<div class="paragraph">
<p><code>merge(options)</code> we merge the <code>json</code> output from running the tests.</p>
</div>
<div class="paragraph">
<p><code>generator.create(jsonReport)</code> then we generate the html view of the report.</p>
</div>
<div class="paragraph">
<p>Check the <a href="https://www.npmjs.com/package/mochawesome-merge"><code>mochawesome-merge</code> documentation</a></p>
</div>
<div class="paragraph">
<p>On <a href="https://github.com/cypress-io/cypress-example-kitchensink">kitchensink</a>
you can find an official cypress demo with all the commands being used.</p>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <div class="bottom-footer">
    <ul>
      <li><a>Impressum</a></li>
    </ul>
  </div>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>
