<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Routing :: devonfw</title>
    <link rel="canonical" href="https://devonfw.com/typescript/current/angular/guide-routing.html">
    <meta name="generator" content="Antora 3.0.2">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://devonfw.com">devonfw</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <!-- <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Support</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Microsoft Teams</a>
            <a class="navbar-item" href="#">Yammer</a>
            <a class="navbar-item" href="#">Email</a>
          </div>
        </div>
        <a class="navbar-item" href="http://adcenter.capgemini.com/">ADCenter</a> -->
        <a class="navbar-item" href="/website/pages/learning/">Tutorials</a>
        <a class="navbar-item" href="/website/pages/solutions/">Solutions</a>
        <a class="navbar-item" href="/website/pages/docs/master.html">Docs</a>
          <div class="navbar-item search hide-for-print">
            <div id="search-field" class="field">
              <input id="search-input" type="text" placeholder="Search the docs">
            </div>
          </div>
        <a class="navbar-github navbar-item" href="https://github.com/devonfw/"></a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="typescript" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Typescript</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../general/general.html">General</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../general/node_version_manager.html">nvm : Node Version Manager</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../general/package_managers.html">Package Managers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../general/package_manager_workflow.html">Package Managers Workflow</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../general/yarn_2.html">Yarn 2</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="angular-home.html">Angular</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="architecture-home.html">Architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ngrx-home.html">NgRx</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="guide-home.html">Guides</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nx-home.html">Nx</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Resources</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="guide-angular-libraries.html">Angular Libraries</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../ionic/ionic_home.html">Ionic</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ionic/ionic_getting_started.html">Ionic Getting Started</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ionic/ionic_to_android.html">Ionic to Android</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ionic/ionic_pwa.html">Ionic Progress Web Apps</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../nestjs/nestjs-home.html">NodeJS </a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Layers</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nestjs/layer-controller.html">Controller</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nestjs/layer-service.html">Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nestjs/layer-dataaccess.html">Data Access</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../nestjs/guide-nestjs-home.html">Guides</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">devon4node applications</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nestjs/samples.html">devon4node Samples</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nestjs/samples-step-by-step.html">devon4node Sample Step by Step</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Resources</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nestjs/guide-nestjs-libraries.html">NestJS Libraries</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Typescript</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../java/current/index.html">Java</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../java/current/index.html">1</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../index.html">Typescript</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Typescript</a></li>
    <li><a href="guide-routing.html">Routing</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/devonfw/typescript/edit/main/modules/ROOT/pages/angular/guide-routing.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Routing</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>A basic introduction to the Angular Router can be found in <a href="https://angular.io/guide/router">Angular Docs</a>.</p>
</div>
<div class="paragraph">
<p>This guide will show common tasks and best practices.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_defining_routes"><a class="anchor" href="#_defining_routes"></a>Defining Routes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For each feature module and the app module all routes should be defined in a separate module with the suffix <code>RoutingModule</code>.
This way the routing modules are the only place where routes are defined.
This pattern achieves a clear separation of concerns.
The following figure illustrates this.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/module-declaration.svg"><img src="../_images/module-declaration.svg" alt="Routing module declaration" width="450"></a>
</div>
<div class="title">Figure 1. Routing module declaration</div>
</div>
<div class="paragraph">
<p>It is important to define routes inside app routing module with <code>.forRoot()</code> and in feature routing modules with <code>.forChild()</code>.</p>
</div>
<div class="sect2">
<h3 id="_example_1_no_lazy_loading"><a class="anchor" href="#_example_1_no_lazy_loading"></a>Example 1 - No Lazy Loading</h3>
<div class="paragraph">
<p>In this example two modules need to be configured with routes - <code>AppModule</code> and <code>FlightModule</code>.</p>
</div>
<div class="paragraph">
<p>The following routes will be configured</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>/</code> will redirect to <code>/search</code></p>
</li>
<li>
<p><code>/search</code> displays <code>FlightSearchComponent</code> (<code>FlightModule</code>)</p>
</li>
<li>
<p><code>/search/print/:flightId/:date</code> displays <code>FlightPrintComponent</code> (<code>FlightModule</code>)</p>
</li>
<li>
<p><code>/search/details/:flightId/:date</code> displays <code>FlightDetailsComponent</code> (<code>FlightModule</code>)</p>
</li>
<li>
<p>All other routes will display <code>ErrorPage404</code> (<code>AppModule</code>)</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">app-routing.module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">const routes: Routes = [
  { path: '', redirectTo: 'search', pathMatch: 'full' },
  { path: '**', component: ErrorPage404 }
];

@NgModule({
  imports: [RouterModule.forRoot(routes)],
  exports: [RouterModule]
})
export class AppRoutingModule { }</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">flight-search-routing.module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">const routes: Routes = [
  {
    path: 'search', children: [
      { path: '', component: FlightSearchComponent },
      { path: 'print/:flightId/:date', component: FlightPrintComponent },
      { path: 'details/:flightId/:date', component: FlightDetailsComponent }
    ]
  }
];

@NgModule({
  imports: [RouterModule.forChild(routes)],
  exports: [RouterModule],
})
export class FlightSearchRoutingModule { }</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The import order inside <code>AppModule</code> is important.
<code>AppRoutingModule</code> needs to be imported <strong>after</strong> <code>FlightModule</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_example_2_lazy_loading"><a class="anchor" href="#_example_2_lazy_loading"></a>Example 2 - Lazy Loading</h3>
<div class="paragraph">
<p>Lazy Loading is a good practice when the application has multiple feature areas and a user might not visit every dialog.
Or at least he might not need every dialog up front.</p>
</div>
<div class="paragraph">
<p>The following example will configure the same routes as example 1 but will lazy load <code>FlightModule</code>.</p>
</div>
<div class="listingblock">
<div class="title">app-routing.module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">const routes: Routes = [
  { path: '/search', loadChildren: 'app/flight-search/flight-search.module#FlightSearchModule' },
  { path: '**', component: ErrorPage404 }
];

@NgModule({
  imports: [RouterModule.forRoot(routes)],
  exports: [RouterModule]
})
export class AppRoutingModule { }</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">flight-search-routing.module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">const routes: Routes = [
  {
    path: '', children: [
      { path: '', component: FlightSearchComponent },
      { path: 'print/:flightId/:date', component: FlightPrintComponent },
      { path: 'details/:flightId/:date', component: FlightDetailsComponent }
    ]
  }
];

@NgModule({
  imports: [RouterModule.forChild(routes)],
  exports: [RouterModule],
})
export class FlightSearchRoutingModule { }</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_triggering_route_changes"><a class="anchor" href="#_triggering_route_changes"></a>Triggering Route Changes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With Angular you have two ways of triggering route changes.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Declarative with bindings in component HTML templates</p>
</li>
<li>
<p>Programmatic with Angular <code>Router</code> service inside component classes</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>On the one hand, architecture-wise it is a much cleaner solution to trigger route changes in <em>Smart Components</em>.
This way you have every UI event that should trigger a navigation handled in one place - in a <em>Smart Component</em>.
It becomes very easy to look inside the code for every navigation, that can occur.
Refactoring is also much easier, as there are no navigation events "hidden" in the HTML templates</p>
</div>
<div class="paragraph">
<p>On the other hand, in terms of accessibility and <code>SEO</code> it is a better solution to rely on bindings in the view - e.g. by using Angular router-link directive.
This way screen readers and the Google crawler can move through the page easily.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you do not have to support accessibility (screen readers, etc.) and to care about <code>SEO</code> (Google rank, etc.),
then you should aim for triggering navigation only in <em>Smart Components</em>.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/triggering-navigation.svg"><img src="../_images/triggering-navigation.svg" alt="Triggering navigation" width="350" height="200"></a>
</div>
<div class="title">Figure 2. Triggering navigation</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_guards"><a class="anchor" href="#_guards"></a>Guards</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Guards are Angular services implemented on routes which determines whether a user can navigate to/from the route. There are examples below which will explain things better. We have the following types of Guards:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>CanActivate</code></strong>: It is used to determine whether a user can visit a route. The most common scenario for this guard is to check if the user is authenticated. For example, if we want only logged in users to be able to go to a particular route, we will implement the <code>CanActivate</code> guard on this route.</p>
</li>
<li>
<p><code><strong>CanActivateChild</strong></code>: Same as above, only implemented on child routes.</p>
</li>
<li>
<p><strong><code>CanDeactivate</code></strong>: It is used to determine if a user can navigate away from a route. Most common example is when a user tries to go to a different page after filling up a form and does not save/submit the changes, we can use this guard to confirm whether the user really wants to leave the page without saving/submitting.</p>
</li>
<li>
<p><strong>Resolve</strong>: For resolving dynamic data.</p>
</li>
<li>
<p><strong><code>CanLoad</code></strong>: It is used to determine whether an <em>Angular module</em> can be loaded lazily. Example below will be helpful to understand it.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s have a look at some examples.</p>
</div>
<div class="sect2">
<h3 id="_example_1_canactivate_and_canactivatechild_guards"><a class="anchor" href="#_example_1_canactivate_and_canactivatechild_guards"></a>Example 1 - <code>CanActivate</code> and <code>CanActivateChild</code> guards</h3>
<div class="sect3">
<h4 id="_canactivate_guard"><a class="anchor" href="#_canactivate_guard"></a><code>CanActivate</code> guard</h4>
<div class="paragraph">
<p>As mentioned earlier, a guard is an Angular service and services are simply <code>TypeScript</code> classes. So we begin by creating a class. This class has to implement the <code>CanActivate</code> interface (imported from <code>angular/router</code>), and therefore, must have a <code>canActivate</code> function. The logic of this function determines whether the requested route can be navigated to or not. It returns either a Boolean value or an <code>Observable</code> or a <code>Promise</code> which resolves to a Boolean value. If it is true, the route is loaded, else not.</p>
</div>
<div class="listingblock">
<div class="title"><code>CanActivate</code> example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">...
import {CanActivate} from "@angular/router";

@Injectable()
class ExampleAuthGuard implements CanActivate {
  constructor(private authService: AuthService) {}

  canActivate(route: ActivatedRouterSnapshot, state: RouterStateSnapshot) {
	if (this.authService.isLoggedIn()) {
      return true;
    } else {
	  window.alert('Please log in first');
      return false;
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, let&#8217;s assume we have a <code>AuthService</code> which has a <code>isLoggedIn()</code> method which returns a Boolean value depending on whether the user is logged in. We use it to return <code>true</code> or <code>false</code> from the <code>canActivate</code> function.
The <code>canActivate</code> function accepts two parameters (provided by Angular). The first parameter of type <code>ActivatedRouterSnapshot</code> is the snapshot of the route the user is trying to navigate to (where the guard is implemented); we can extract the route parameters from this instance. The second parameter of type <code>RouterStateSnapshot</code> is a snapshot of the router state the user is trying to navigate to; we can fetch the <code>URL</code> from it&#8217;s <code>url</code> property.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
We can also redirect the user to another page (maybe a login page) if the <code>authService</code> returns false. To do that, inject <code>Router</code> and use it&#8217;s <code>navigate</code> function to redirect to the appropriate page.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Since it is a service, it needs to be provided in our module:</p>
</div>
<div class="listingblock">
<div class="title">provide the guard in a module</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">@NgModule({
  ...
  providers: [
    ...
    ExampleAuthGuard
  ]
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now this guard is ready to use on our routes. We implement it where we define our array of routes in the application:</p>
</div>
<div class="listingblock">
<div class="title">Implementing the guard</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">...
const routes: Routes = [
  { path: '', redirectTo: 'home', pathMatch: 'full' },
  { path: 'home', component: HomeComponent },
  { path: 'page1', component: Page1Component, canActivate: [ExampleAuthGuard] }
];</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, the <code>canActivate</code> property accepts an array of guards. So we can implement more than one guard on a route.</p>
</div>
</div>
<div class="sect3">
<h4 id="_canactivatechild_guard"><a class="anchor" href="#_canactivatechild_guard"></a><code>CanActivateChild</code> guard</h4>
<div class="paragraph">
<p>To use the guard on nested (children) routes, we add it to the <code>canActivateChild</code> property like so:</p>
</div>
<div class="listingblock">
<div class="title">Implementing the guard on child routes</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">...
const routes: Routes = [
  { path: '', redirectTo: 'home', pathMatch: 'full' },
  { path: 'home', component: HomeComponent },
  { path: 'page1', component: Page1Component, canActivateChild: [ExampleAuthGuard], children: [
	{path: 'sub-page1', component: SubPageComponent},
    {path: 'sub-page2', component: SubPageComponent}
  ] }
];</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_example_2_canload_guard"><a class="anchor" href="#_example_2_canload_guard"></a>Example 2 - <code>CanLoad</code> guard</h3>
<div class="paragraph">
<p>Similar to <code>CanActivate</code>, to use this guard we implement the <code>CanLoad</code> interface and overwrite it&#8217;s <code>canLoad</code> function. Again, this function returns either a Boolean value or an <code>Observable</code> or a <code>Promise</code> which resolves to a Boolean value. The fundamental difference between <code>CanActivate</code> and <code>CanLoad</code> is that <code>CanLoad</code> is used to determine whether an entire module can be lazily loaded or not. If the guard returns <code>false</code> for a module protected by <code>CanLoad</code>, the entire module is not loaded.</p>
</div>
<div class="listingblock">
<div class="title"><code>CanLoad</code> example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">...
import {CanLoad, Route} from "@angular/router";

@Injectable()
class ExampleCanLoadGuard implements CanLoad {
  constructor(private authService: AuthService) {}

  canLoad(route: Route) {
	if (this.authService.isLoggedIn()) {
      return true;
    } else {
	  window.alert('Please log in first');
      return false;
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again, let&#8217;s assume we have a <code>AuthService</code> which has a <code>isLoggedIn()</code> method which returns a Boolean value depending on whether the user is logged in. The <code>canLoad</code> function accepts a parameter of type Route which we can use to fetch the path a user is trying to navigate to (using the <code>path</code> property of <code>Route</code>).</p>
</div>
<div class="paragraph">
<p>This guard needs to be provided in our module like any other service.</p>
</div>
<div class="paragraph">
<p>To implement the guard, we use the <code>canLoad</code> property:</p>
</div>
<div class="listingblock">
<div class="title">Implementing the guard</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">...
const routes: Routes = [
  { path: 'home', component: HomeComponent },
  { path: 'admin', loadChildren: 'app/admin/admin.module#AdminModule', canLoad: [ExampleCanLoadGuard] }
];</code></pre>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>
