<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Component Decomposition :: devonfw</title>
    <link rel="canonical" href="https://devonfw.com/docs/typescript/current/angular/guide-component-decomposition.html">
    <meta name="generator" content="Antora 3.0.2">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://devonfw.com/">devonfw</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
    <div class="navbar-end">
        <a class="navbar-item" href="/docs/java/current/">Java</a>
        <a class="navbar-item" href="/docs/typescript/current/">TypeScript</a>
        <a class="navbar-item" href="https://github.com/devonfw/ide">IDE</a>
        <a class="navbar-item" href="https://github.com/devonfw/hangar">CI/CD</a>
        <a class="navbar-item" href="/website/pages/learning/">Tutorials</a>
        <a class="navbar-item" href="/website/pages/solutions/">Solutions</a>
        <a class="navbar-item" href="/website/pages/docs/master.html">Legacy Docs</a>
          <div class="navbar-item search hide-for-print">
            <div id="search-field" class="field">
              <input id="search-input" type="text" placeholder="Search the docs">
            </div>
          </div>
        <a class="navbar-github navbar-item" href="https://github.com/devonfw/"></a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="typescript" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Typescript</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../general/general.html">General</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../general/node_version_manager.html">nvm : Node Version Manager</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../general/package_managers.html">Package Managers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../general/package_manager_workflow.html">Package Managers Workflow</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../general/yarn_2.html">Yarn 2</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="angular-home.html">Angular</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="architecture-home.html">Architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ngrx-home.html">NgRx</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="guide-home.html">Guides</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nx-home.html">Nx</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Resources</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="guide-angular-libraries.html">Angular Libraries</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../ionic/ionic_home.html">Ionic</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ionic/ionic_getting_started.html">Ionic Getting Started</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ionic/ionic_to_android.html">Ionic to Android</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ionic/ionic_pwa.html">Ionic Progress Web Apps</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../nestjs/nestjs-home.html">NodeJS </a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Layers</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nestjs/layer-controller.html">Controller</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nestjs/layer-service.html">Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nestjs/layer-dataaccess.html">Data Access</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../nestjs/guide-nestjs-home.html">Guides</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">devon4node applications</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nestjs/samples.html">devon4node Samples</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nestjs/samples-step-by-step.html">devon4node Sample Step by Step</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Resources</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nestjs/guide-nestjs-libraries.html">NestJS Libraries</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Typescript</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../java/current/index.html">Java</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../java/current/index.html">1</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../index.html">Typescript</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Typescript</a></li>
    <li><a href="guide-component-decomposition.html">Component Decomposition</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/devonfw/typescript/edit/main/modules/ROOT/pages/angular/guide-component-decomposition.adoc">Contribute to this page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<div id="contribution-overlay" class="contribution-overlay"></div>
<div id="contribution-div" class="contribution">
  <button id="contribution-btn" class="contribution-btn"><span class="close">&times</span></button>
  <div class="contribution-container">
      <div class="contribution-img"> </div>
      <h2> Contribute to help us improve!</h2> 
      <p> Are there edge cases or problems that we didn't consider? Is there a technical pitfall that we should add? Did we miss a comma in a sentence? </p>
      <p> If you have any input for us, we would love to hear from you and appreciate every contribution. Our goal is to learn from projects for projects such that nobody has to reinvent the wheel. </p>
      <p> Let's collect our experiences together to make room to explore the novel! </p> 
      <p> To contribute click on <span class="devonfw-primary-color">Contribute to this page</span> on the toolbar.</p>
  </div>
</div><h1 class="page">Component Decomposition</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>When implementing a new requirement there are a few design decisions, which need to be considered.
A decomposition in <em>Smart</em> and <em>Dumb Components</em> should be done first.
This includes the definition of state and responsibilities.
Implementing a new dialog will most likely be done by defining a new <em>Smart Component</em> with multiple <em>Dumb Component</em> children.</p>
</div>
<div class="paragraph">
<p>In the component tree this would translate to the definition of a new sub-tree.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/component-tree-highlighted-subtree.svg"><img src="../_images/component-tree-highlighted-subtree.svg" alt="Component Tree With Highlighted Sub Tree" width="450"></a>
</div>
<div class="title">Figure 1. Component Tree with highlighted sub-tree</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_defining_components"><a class="anchor" href="#_defining_components"></a>Defining Components</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following gives an example for component decomposition.
Shown is a screenshot from a style guide to be implemented.
It is a widget called <code>Listpicker</code>.</p>
</div>
<div class="paragraph">
<p>The basic function is an <code>input</code> field accepting direct input.
So typing <code>otto</code> puts <code>otto</code> inside the <code>FormControl</code>.
With arrow down key or by clicking the icon displayed in the inputs right edge a dropdown is opened.
Inside possible values can be selected and filtered beforehand.
After pressing arrow down key the focus should move into the filter input field.
Up and down arrow keys can be used to select an element from the list.
Typing into the filter input field filters the list from which the elements can be selected.
The current selected element is highlighted with green background color.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/component-decomposition-example-1.svg"><img src="../_images/component-decomposition-example-1.svg" alt="Component Decomposition Example 1v2" width="450"></a>
</div>
<div class="title">Figure 2. Component decomposition example before</div>
</div>
<div class="paragraph">
<p>What should be done, is to define small reusable <em>Dumb Components</em>.
This way the complexity becomes manageable.
In the example every colored box describes a component with the purple box being a <em>Smart Component</em>.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/component-decomposition-example-2.svg"><img src="../_images/component-decomposition-example-2.svg" alt="Component Decomposition Example 2v2" width="450"></a>
</div>
<div class="title">Figure 3. Component decomposition example after</div>
</div>
<div class="paragraph">
<p>This leads to the following component tree.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/component-decomposition-example-component-tree.svg"><img src="../_images/component-decomposition-example-component-tree.svg" alt="Component Decomposition Example component tree" width="450"></a>
</div>
<div class="title">Figure 4. Component decomposition example component tree</div>
</div>
<div class="paragraph">
<p>Note the uppermost component is a <em>Dumb Component</em>.
It is a wrapper for the label and the component to be displayed inside a form.
The <em>Smart Component</em> is <code>Listpicker</code>.
This way the widget can be reused without a form needed.</p>
</div>
<div class="paragraph">
<p>A widgets is a typical <em>Smart Component</em> to be shared across feature modules.
So the <code>SharedModule</code> is the place for it to be defined.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_defining_state"><a class="anchor" href="#_defining_state"></a>Defining state</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Every UI has state.
There are different kinds of state, for example</p>
</div>
<div class="ulist">
<ul>
<li>
<p>View State: e.g. is a panel open, a css transition pending, etc.</p>
</li>
<li>
<p>Application State: e.g. is a payment pending, current URL, user info, etc.</p>
</li>
<li>
<p>Business Data: e.g. products loaded from back-end</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is good practice to base the component decomposition on the state handled by a component and to define a simplified state model beforehand.
Starting with the parent - the <em>Smart Component</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What overall state does the dialog have: e.g. loading, error, valid data loaded, valid input, invalid input, etc.
Every defined value should correspond to an overall appearance of the whole dialog.</p>
</li>
<li>
<p>What events can occur to the dialog: e.g. submitting a form, changing a filter, pressing buttons, pressing keys, etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For every <em>Dumb Component</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What data does a component display: e.g. a header text, user information to be displayed, a loading flag, etc.<br>
This will be a slice of the overall state of the parent <em>Smart Component</em>.
In general a <em>Dumb Component</em> presents a slice of its parent <em>Smart Components</em> state to the user.</p>
</li>
<li>
<p>What events can occur: keyboard events, mouse events, etc.<br>
These events are all handled by its parent <em>Smart Component</em> - every event is passed up the tree to be handled by a <em>Smart Component</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These information should be reflected inside the modeled state.
The implementation is a TypeScript type - an interface or a class describing the model.</p>
</div>
<div class="paragraph">
<p>So there should be a type describing all state relevant for a <em>Smart Component</em>.
An instance of that type is send down the component tree at runtime.
Not every <em>Dumb Component</em> will need the whole state.
For instance a single <em>Dumb Component</em> could only need a single string.</p>
</div>
<div class="paragraph">
<p>The state model for the previous <code>Listpicker</code> example is shown in the following listing.</p>
</div>
<div class="listingblock">
<div class="title"><code>Listpicker</code> state model</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">export class ListpickerState {

  items: {}[]|undefined;
  columns = ['key', 'value'];
  keyColumn = 'key';
  displayValueColumn = 'value';
  filteredItems: {}[]|undefined;
  filter = '';
  placeholder = '';
  caseSensitive = true;
  isDisabled = false;
  isDropdownOpen = false;
  selectedItem: {}|undefined;
  displayValue = '';

}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>Listpicker</code> holds an instance of <code>ListpickerState</code> which is passed down the component tree via <code>@Input()</code> bindings in the <em>Dumb Components</em>.
Events emitted by children - <em>Dumb Components</em> - create a new instance of <code>ListpickerState</code> based on the current instance and the event and its data.
So a state transition is just setting a new instance of <code>ListpickerState</code>.
Angular Bindings propagate the value down the tree after exchanging the state.</p>
</div>
<div class="listingblock">
<div class="title"><code>Listpicker</code> State transition</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">export class ListpickerComponent {

  // initial default values are set
  state = new ListpickerState();

  /** User changes filter */
  onFilterChange(filter: string): void {
    // apply filter ...
    const filteredList = this.filterService.filter(...);

    // important: A new instance is created, instead of altering the existing one.
    //            This makes change detection easier and prevents hard to find bugs.
    this.state = Object.assing({}, this.state, {
      filteredItems: filteredList,
      filter: filter
    });
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Note:</div>
<p>It is not always necessary to define the model as independent type.
So there would be no state property and just properties for every state defined directly in the component class.
When complexity grows and state becomes larger this is usually a good idea.
If the state should be shared between <em>Smart Components</em> a store is to be used.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_when_are_dumb_components_needed"><a class="anchor" href="#_when_are_dumb_components_needed"></a>When are Dumb Components needed</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sometimes it is not necessary to perform a full decomposition. The architecture does not enforce it generally. What you should keep in mind is, that there is always a point when it becomes recommendable.</p>
</div>
<div class="paragraph">
<p>For example a template with 800 line of code is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>not understandable</p>
</li>
<li>
<p>not maintainable</p>
</li>
<li>
<p>not testable</p>
</li>
<li>
<p>not reusable</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>So when implementing a template with more than 50 line of code you should think about decomposition.</p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <div class="bottom-footer">
    <ul>
      <li><a href="https://devonfw.com/website/pages/docs/devonfw-guide_ide.wiki_LICENSE.asciidoc.html">Terms of use</a></li>
    </ul>
  </div>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>
