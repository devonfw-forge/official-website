<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Angular Lazy loading :: devonfw</title>
    <link rel="canonical" href="https://devonfw.com/docs/typescript/current/angular/guide-angular-lazy-loading.html">
    <meta name="generator" content="Antora 3.0.2">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://devonfw.com/docs">devonfw</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
    <div class="navbar-end">
        <a class="navbar-item" href="/docs/java/current/">Java</a>
        <a class="navbar-item" href="/docs/typescript/current/">TypeScript</a>
        <a class="navbar-item" href="#">IDE</a>
        <a class="navbar-item" href="#">CI/CD</a>
        <a class="navbar-item" href="/website/pages/learning/">Tutorials</a>
        <a class="navbar-item" href="/website/pages/solutions/">Solutions</a>
        <a class="navbar-item" href="/website/pages/docs/master.html">Legacy Docs</a>
          <div class="navbar-item search hide-for-print">
            <div id="search-field" class="field">
              <input id="search-input" type="text" placeholder="Search the docs">
            </div>
          </div>
        <a class="navbar-github navbar-item" href="https://github.com/devonfw/"></a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="typescript" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Typescript</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../general/general.html">General</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../general/node_version_manager.html">nvm : Node Version Manager</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../general/package_managers.html">Package Managers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../general/package_manager_workflow.html">Package Managers Workflow</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../general/yarn_2.html">Yarn 2</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="angular-home.html">Angular</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="architecture-home.html">Architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ngrx-home.html">NgRx</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="guide-home.html">Guides</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="nx-home.html">Nx</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Resources</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="guide-angular-libraries.html">Angular Libraries</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../ionic/ionic_home.html">Ionic</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ionic/ionic_getting_started.html">Ionic Getting Started</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ionic/ionic_to_android.html">Ionic to Android</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ionic/ionic_pwa.html">Ionic Progress Web Apps</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../nestjs/nestjs-home.html">NodeJS </a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Layers</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nestjs/layer-controller.html">Controller</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nestjs/layer-service.html">Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nestjs/layer-dataaccess.html">Data Access</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../nestjs/guide-nestjs-home.html">Guides</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">devon4node applications</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nestjs/samples.html">devon4node Samples</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nestjs/samples-step-by-step.html">devon4node Sample Step by Step</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Resources</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nestjs/guide-nestjs-libraries.html">NestJS Libraries</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Typescript</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../java/current/index.html">Java</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../java/current/index.html">1</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../index.html">Typescript</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Typescript</a></li>
    <li><a href="guide-angular-lazy-loading.html">Angular Lazy loading</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/devonfw/typescript/edit/main/modules/ROOT/pages/angular/guide-angular-lazy-loading.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Angular Lazy loading</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>When the development of an application starts, it just contains a small set of features so the app usually loads fast. However, as new features are added, the overall application size grows up  and its loading speed decreases. It is in this context where Lazy loading finds its place.
Lazy loading is a design pattern that defers initialization of objects until it is needed, so, for example, users that just access to a website&#8217;s home page do not need to have other areas loaded.
Angular handles lazy loading through the routing module which redirects to requested pages. Those pages can be loaded at start or on demand.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_an_example_with_angular"><a class="anchor" href="#_an_example_with_angular"></a>An example with Angular</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To explain how lazy loading is implemented using angular, a basic sample app is going to be developed. This app will consist in a window named "level 1" that contains two buttons that redirects to other windows in a "second level". It is a simple example, but useful to understand the relation between angular modules and lazy loading.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/angular/angular-lazy/levels-app.png" alt="Levels app structure" width="500 link="images/angular/angular-lazy/levels-app.png"">
</div>
<div class="title">Figure 1. Levels app structure.</div>
</div>
<div class="paragraph">
<p>This graphic shows that modules acts as gates to access components "inside" them.</p>
</div>
<div class="paragraph">
<p>Because the objective of this guide is related mainly with logic, the html structure and SCSS styles are less relevant, but the complete code can be found as a sample <a href="https://github.com/devonfw-sample/devon4ts-samples/tree/master/apps/angular-lazy-loading">here</a>.</p>
</div>
<div class="sect2">
<h3 id="_implementation"><a class="anchor" href="#_implementation"></a>Implementation</h3>
<div class="paragraph">
<p>First write in a console <code>ng new level-app --routing</code>, to generate a new project called level-app including an app-routing.module.ts file (<strong>--routing</strong> flag). If you are using Nx, the command would be <code>nx generate @nrwl/angular:app level-app --routing</code> in your Nx workspace.</p>
</div>
<div class="paragraph">
<p>In the file app.component.html delete all the content except the router-outlet tag.</p>
</div>
<div class="listingblock">
<div class="title">File app.component.html</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">&lt;router-outlet&gt;&lt;/router-outlet&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The next steps consists on creating features modules.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>run <code>ng generate module first --routing</code>  to generate a module named <em>first</em>.</p>
</li>
<li>
<p>run <code>ng generate module first/second-left --routing</code> to generate a module named <em>second-left</em> under <em>first</em>.</p>
</li>
<li>
<p>run <code>ng generate module first/second-right --routing</code> to generate a module <em>second-right</em> under <em>first</em>.</p>
</li>
<li>
<p>run <code>ng generate component first/first</code> to generate a component named <em>first</em> inside the module <em>first</em>.</p>
</li>
<li>
<p>run <code>ng generate component first/second-left/content</code> to generate a component <em>content</em> inside the module <em>second-left</em>.</p>
</li>
<li>
<p>run <code>ng generate component first/second-right/content</code> to generate a component <em>content</em> inside the module <em>second-right</em>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="literalblock">
<div class="content">
<pre>If you are using Nx, you have to specify the project name (level-app) along with the --project flag. For example, command for generating the first module will be `ng generate module first --project=level-app --routing`</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To move between components we have to configure the routes used:</p>
</div>
<div class="paragraph">
<p>In <strong>app-routing.module.ts</strong> add a path <strong>'first'</strong> to <code>FirstComponent</code> and a redirection from <strong>''</strong> to <strong>'first'</strong>.</p>
</div>
<div class="listingblock">
<div class="title">File app-routing.module.ts.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">...
import { FirstComponent } from './first/first/first.component';

const routes: Routes = [
  {
    path: 'first',
    component: FirstComponent
  },
  {
    path: '',
    redirectTo: 'first',
    pathMatch: 'full',
  },
];

@NgModule({
  imports: [RouterModule.forRoot(routes)],
  exports: [RouterModule],
})
export class AppRoutingModule {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In <strong>app.module.ts</strong> import the module which includes <code>FirstComponent</code>.</p>
</div>
<div class="listingblock">
<div class="title">File app.module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">....
import { FirstModule } from './first/first.module';

@NgModule({
  ...
  imports: [
    ....
    FirstModule
  ],
  ...
})
export class AppModule { }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In <strong>first-routing.module.ts</strong> add routes that direct to the content of <code>SecondRightModule</code> and <code>SecondLeftModule</code>. The content of both modules have the same name so, in order to avoid conflicts the name of the components are going to be changed using <strong>as</strong> ( original-name as new-name).</p>
</div>
<div class="listingblock">
<div class="title">File first-routing.module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">...
import { ContentComponent as ContentLeft} from './second-left/content/content.component';
import { ContentComponent as ContentRight} from './second-right/content/content.component';
import { FirstComponent } from './first/first.component';

const routes: Routes = [
  {
    path: '',
    component: FirstComponent
  },
  {
    path: 'first/second-left',
    component: ContentLeft
  },
  {
    path: 'first/second-right',
    component: ContentRight
  }
];

@NgModule({
  imports: [RouterModule.forChild(routes)],
  exports: [RouterModule]
})
export class FirstRoutingModule { }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In first.module.ts import <code>SecondLeftModule</code> and <code>SecondRightModule</code>.</p>
</div>
<div class="listingblock">
<div class="title">File first.module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">...
import { SecondLeftModule } from './second-left/second-left.module';
import { SecondRightModule } from './second-right/second-right.module';

@NgModule({
  ...
  imports: [
    ...
    SecondLeftModule,
    SecondRightModule,
  ]
})
export class FirstModule { }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using the current configuration, we have a project that loads all the modules in a eager way. Run <code>ng serve</code> (with <code>--project=level-app</code> in an Nx workspace) to see what happens.</p>
</div>
<div class="paragraph">
<p>First, during the compilation we can see that just a main file is built.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/angular/angular-lazy/compile-eager.png" alt="Compile eager" width="800 link="images/angular/angular-lazy/compile-eager.png"">
</div>
<div class="title">Figure 2. Compile eager.</div>
</div>
<div class="paragraph">
<p>If we go to <code><a href="http://localhost:4200/first" class="bare">http://localhost:4200/first</a></code> and open developer options (F12 on Chrome), it is found that a document named "first" is loaded.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/angular/angular-lazy/first-lvl-eager.png" alt="First level eager" width="800 link="images/angular/angular-lazy/first-lvl-eager.png"">
</div>
<div class="title">Figure 3. First level eager.</div>
</div>
<div class="paragraph">
<p>If we click on <strong>[Go to right module]</strong> a second level module opens, but there is no 'second-right' document.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/angular/angular-lazy/second-lvl-right-eager.png" alt="Second level right eager" width="800 link="images/angular/angular-lazy/second-lvl-right-eager.png"">
</div>
<div class="title">Figure 4. Second level right eager.</div>
</div>
<div class="paragraph">
<p>But, typing the URL directly will load 'second-right' but no 'first', even if we click on <strong>[Go back]</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/angular/angular-lazy/second-lvl-right-eager-d.png" alt="Second level right eager" width="800 link="images/angular/angular-lazy/second-lvl-right-eager-d.png"">
</div>
<div class="title">Figure 5. Second level right eager direct URL.</div>
</div>
<div class="paragraph">
<p>Modifying an angular application to load its modules lazily is easy, you have to change the routing configuration of the desired module (for example <code>FirstModule</code>).</p>
</div>
<div class="listingblock">
<div class="title">File app-routing.module.ts.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">const routes: Routes = [
  {
    path: 'first',
    loadChildren: () =&gt; import('./first/first.module').then(m =&gt; m.FirstModule),
  },
  {
    path: '',
    redirectTo: 'first',
    pathMatch: 'full',
  },
];

@NgModule({
  imports: [RouterModule.forRoot(routes)],
  exports: [RouterModule],
})
export class AppRoutingModule {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that instead of loading a component, you dynamically import it in a <code>loadChildren</code> attribute because modules acts as gates to access components "inside" them. Updating the app to load lazily has four consequences:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>No component attribute.</p>
</li>
<li>
<p>No import of <code>FirstComponent</code>.</p>
</li>
<li>
<p><code>FirstModule</code> import has to be removed from the imports array at app.module.ts.</p>
</li>
<li>
<p>Change of context.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If we check <strong>first-routing.module.ts</strong> again, we can see that the path for <code>ContentLeft</code> and <code>ContentRight</code> is set to 'first/second-left' and 'first/second-right' respectively, so writing <code><a href="http://localhost:4200/first/second-left" class="bare">http://localhost:4200/first/second-left</a></code> will redirect us to <code>ContentLeft</code>. However, after loading a module with <code>loadChildren</code> setting the path to '<em>second-left</em>' and '<em>second-right</em>' is enough because it acquires the context set by <code>AppRoutingModule</code>.</p>
</div>
<div class="listingblock">
<div class="title">File first-routing.module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">const routes: Routes = [
  {
    path: '',
    component: FirstComponent
  },
  {
    path: 'second-left',
    component: ContentLeft
  },
  {
    path: 'second-right',
    component: ContentRight
  }
];</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we go to '<em>first</em>' then <code>FirstModule</code> is situated in '<em>/first</em>' but also its children <code>ContentLeft</code> and <code>ContentRight</code>, so it is not necessary to write in their path '<em>first/second-left</em>' and '<em>first/second-right</em>', because that will situate the components on '<em>first/first/second-left</em>' and  '<em>first/first/second-right</em>'.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/angular/angular-lazy/first-lvl-wrong-path.png" alt="First level wrong path" width="800 link="images/angular/angular-lazy/first-lvl-wrong-path.png"">
</div>
<div class="title">Figure 6. First level lazy wrong path.</div>
</div>
<div class="paragraph">
<p>When we compile an app with lazy loaded modules, files containing them will be generated</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/angular/angular-lazy/compile-first-lazy.png" alt="First level lazy compilation" width="800 link="images/angular/angular-lazy/compile-first-lazy.png"">
</div>
<div class="title">Figure 7. First level lazy compilation.</div>
</div>
<div class="paragraph">
<p>And if we go to <em>developer tools &#8594; network</em>, we can find those modules loaded (if they are needed).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/angular/angular-lazy/first-lvl-lazy.png" alt="First level lazy" width="800 link="images/angular/angular-lazy/first-lvl-lazy.png"">
</div>
<div class="title">Figure 8. First level lazy.</div>
</div>
<div class="paragraph">
<p>To load the component <code>ContentComponent</code> of <code>SecondLeftModule</code> lazily, we have to load <code>SecondLeftModule</code> as a children of <code>FirstModule</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Change <strong>component</strong> to <code>loadChildren</code> and reference <code>SecondLeftModule</code>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">File first-routing.module.ts.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">const routes: Routes = [
  {
    path: '',
    component: FirstComponent
  },
  {
    path: 'second-left',
    loadChildren: () =&gt; import('./second-left/second-left.module').then(m =&gt; m.SecondLeftModule),
  },
  {
    path: 'second-right',
    component: ContentRight
  }
];</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Remove <code>SecondLeftModule</code> at first.component.ts</p>
</li>
<li>
<p>Route the components inside <code>SecondLeftModule</code>. Without this step nothing would be displayed.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">File second-left-routing.module.ts.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">...
import { ContentComponent } from './content/content.component';

const routes: Routes = [
  {
    path: '',
    component: ContentComponent
  }
];

@NgModule({
  imports: [RouterModule.forChild(routes)],
  exports: [RouterModule]
})
export class SecondLeftRoutingModule { }</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>run <code>ng serve</code> to generate files containing the lazy modules.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/angular/angular-lazy/second-lvl-lazy.png" alt="Second level lazy" width="800 link="images/angular/angular-lazy/second-lvl-lazy.png"">
</div>
<div class="title">Figure 9. Second level lazy loading compilation.</div>
</div>
<div class="paragraph">
<p>Clicking on <strong>[Go to left module]</strong> triggers the load of <code>SecondLeftModule</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/angular/angular-lazy/second-lvl-left-lazy.png" alt="Second level lazy network" width="800 link="images/angular/angular-lazy/second-lvl-left-lazy.png"">
</div>
<div class="title">Figure 10. Second level lazy loading network.</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion"><a class="anchor" href="#_conclusion"></a>Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Lazy loading is a pattern useful when new features are added, these features are usually identified as modules which can be loaded only if needed as shown in this document, reducing the time spent loading an application.</p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <div class="bottom-footer">
    <ul>
      <li><a>Impressum</a></li>
    </ul>
  </div>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>
