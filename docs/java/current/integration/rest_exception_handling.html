<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>RESTful Exception Handling :: devonfw</title>
    <link rel="canonical" href="https://devonfw.com/docs/java/current/integration/rest_exception_handling.html">
    <meta name="generator" content="Antora 3.0.2">
    <link rel="stylesheet" href="../../../_/css/site.css">
<meta property="og:title" content="1/integration/rest_exception_handling.adoc" />    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://devonfw.com/">devonfw</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
    <div class="navbar-end">
        <a class="navbar-item" href="https://devonfw.com/docs/java/current/">Java</a>
        <a class="navbar-item" href="https://devonfw.com/docs/typescript/current/">TypeScript</a>
        <a class="navbar-item" href="https://github.com/devonfw/ide">IDE</a>
        <a class="navbar-item" href="https://github.com/devonfw/hangar">CI/CD</a>
        <a class="navbar-item" href="https://devonfw.com/website/pages/learning/">Tutorials</a>
        <a class="navbar-item" href="https://devonfw.com/website/pages/docs/master.html">Legacy Docs</a>
          <div class="navbar-item search hide-for-print">
            <div id="search-field" class="field">
              <input id="search-input" type="text" placeholder="Search the docs">
            </div>
          </div>
        <a class="navbar-github navbar-item" href="https://github.com/devonfw/"></a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="java" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Java</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../getting_started/getting_started.html">Getting started</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../getting_started/create_rest_service.html">Create a REST service</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Architecture</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../architecture/layered_architecture.html">Layered Architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../architecture/hexagonale_architecture.html">Hexagonal Architecture</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Integration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="rest_service.html">REST</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="rest_exception_handling.html">RESTful Exception Handling</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="rest_service_json.html">JSON</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="rest_openapi.html">Open Api Generator</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Persistence</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Relational Databases</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../persistence/jpa.html">JPA</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../persistence/transactional.html">Transaction</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Cross cutting</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../cross_cutting/coding_conventions.html">Coding Conventions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../cross_cutting/configuration.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../cross_cutting/dependency_injection.html">Dependency Injection</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../cross_cutting/exceptions.html">Exceptions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../cross_cutting/i18n.html">Internationalization (I18N)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../cross_cutting/oauth2_proxy.html">Authentication with Keycloak using a OAuth 2 Proxy</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../cross_cutting/logging.html">Logging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Security</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cross_cutting/security/authentication.html">Authentication</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cross_cutting/security/authorization.html">Authorization</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cross_cutting/security/cors.html">CORS</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cross_cutting/security/csrf.html">CSRF</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../cross_cutting/tracing.html">Tracing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../cross_cutting/test_automation/test_automation.html">Test Automation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cross_cutting/test_automation/unit_tests.html">Unit Tests</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cross_cutting/test_automation/sub_system_tests.html">Subsystem- and System-Tests</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cross_cutting/test_automation/contract_tests.html">Consumer Driven Contract (CDC) Tests</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../cross_cutting/test_automation/architecture_tests.html">Architecture Tests</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Examples</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../examples/my-thai-star.html">My-Thai-Star Sample Application</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Java</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Java</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../typescript/current/index.html">Typescript</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../typescript/current/index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Java</a></li>
    <li>Integration</li>
    <li><a href="rest_service.html">REST</a></li>
    <li><a href="rest_exception_handling.html">RESTful Exception Handling</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/devonfw/java/edit/main/modules/ROOT/pages/integration/rest_exception_handling.adoc">Contribute to this page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<div id="contribution-overlay" class="contribution-overlay"></div>
<div id="contribution-div" class="contribution">
  <button id="contribution-btn" class="contribution-btn"><span class="close">&times</span></button>
  <div class="contribution-container">
      <div class="contribution-img"> </div>
      <h2> Contribute to help us improve!</h2> 
      <p> Are there edge cases or problems that we didn't consider? Is there a technical pitfall that we should add? Did we miss a comma in a sentence? </p>
      <p> If you have any input for us, we would love to hear from you and appreciate every contribution. Our goal is to learn from projects for projects such that nobody has to reinvent the wheel. </p>
      <p> Let's collect our experiences together to make room to explore the novel! </p> 
      <p> To contribute click on <span class="devonfw-primary-color">Contribute to this page</span> on the toolbar.</p>
  </div>
</div><h1 class="page">RESTful Exception Handling</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This article gives advice on a proper exception handling in the service layer.
It is important to catch all exceptions and map them to a meaningful result and not pass implementation details to the outside.
If not handled correct a generated error message is send to the client.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_use_rfc_7807_for_error_responses"><a class="anchor" href="#_use_rfc_7807_for_error_responses"></a>Use RFC 7807 for error responses</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://www.rfc-editor.org/rfc/rfc7807">RFC7807</a> defines a "problem detail" so no new response formats need to be defined.
It&#8217;s recommended to go with the described format.
In the following chapters a few recommendations based on the RFC are documented</p>
</div>
<div class="sect2">
<h3 id="_do_not_use_urls"><a class="anchor" href="#_do_not_use_urls"></a>Do not use URLs</h3>
<div class="paragraph">
<p>The RFC describes at least title and instance to be URIs.
Often readers imagine callable URLs at this place, which leads to a lot of complex solutions ideas.
Consider using URNs instead of URLs to be most flexible and still aligning with the specification.</p>
</div>
</div>
<div class="sect2">
<h3 id="_define_a_problem_type_and_title_as_constant_string"><a class="anchor" href="#_define_a_problem_type_and_title_as_constant_string"></a>Define a problem type and title as constant string</h3>
<div class="paragraph">
<p>The type should be a URN that identifies the underlying error.
Use <code>urn:problem:&lt;error-code&gt;</code> as type.</p>
</div>
<div class="paragraph">
<p><code>&lt;error-code&gt;</code> should identify the underlying error and should not change.
The classname e.g. is not a good error-code as it might change due to refactoring work.
It&#8217;s best to have a mapping of exception class to error-code.</p>
</div>
<div class="paragraph">
<p>It&#8217;s recommended to use a String representation of the error like ValidationError, ResourceNotFound. But it could also be a number.</p>
</div>
<div class="paragraph">
<p>The title should be a human understandable definition of the type.
The same type should always match to the same title.
E.g.: ValidationError - The request was not valid. ResourceNotFound - A resource was not found</p>
</div>
<div class="paragraph">
<p>The details can be used to provide further information like the Validation Problems or the id and type of the resource that was not found.</p>
</div>
</div>
<div class="sect2">
<h3 id="_use_a_unique_identifier_to_define_the_instance"><a class="anchor" href="#_use_a_unique_identifier_to_define_the_instance"></a>Use a unique identifier to define the instance</h3>
<div class="paragraph">
<p>The instance should identify the concrete error that occurs.
It&#8217;s recommended to use a UUID to define this.
<code>urn:uuid:&lt;UUID&gt;</code></p>
</div>
<div class="paragraph">
<p>In cases where there&#8217;s a trace-id this could be used.
This way it&#8217;s easiest for the operations team to quickly identify the requests related to the error.</p>
</div>
<div class="paragraph">
<p>If no ID can be reused that marks the error instance, a new UUID should be created and logged out together with helpful information.</p>
</div>
</div>
<div class="sect2">
<h3 id="_use_an_openapi_specification_to_define_the_problem_details"><a class="anchor" href="#_use_an_openapi_specification_to_define_the_problem_details"></a>Use an OpenAPI specification to define the problem details</h3>
<div class="paragraph">
<p>OpenAPI can be used to define and generate the problem details.
This is especially helpful, when additional attributes are used, that are not defined by the specification.
That way the caller can expect further information and display it.</p>
</div>
<div class="paragraph">
<p>When inheritance for the problem details is used in the OpenAPI spec, define an additional <code>_schema</code> attribute as discriminator for the concrete type. For more details take a look at the <a href="https://github.com/OAI/OpenAPI-Specification/blob/main/versions/3.1.0.md#composition-and-inheritance-polymorphism">openAPI specification</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_exception_types"><a class="anchor" href="#_exception_types"></a>Exception Types</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Special exceptions have clear requirements regarding the information that is exposed.</p>
</div>
<div class="sect2">
<h3 id="_do_not_expose_any_information_on_security_exceptions"><a class="anchor" href="#_do_not_expose_any_information_on_security_exceptions"></a>Do not expose any information on Security Exceptions</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP status code</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">403 (FORBIDDEN)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">about:blank</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">title</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"forbidden"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">details</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">empty</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">instance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An identifier (generally the correlation id) to help identify corresponding requests in logs</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_log_all_validation_errors_of_validation_exceptions"><a class="anchor" href="#_log_all_validation_errors_of_validation_exceptions"></a>Log all validation errors of Validation Exceptions</h3>
<div class="paragraph">
<p>Validation errors include <strong>all</strong> validation issues that do not fullfil the requirements, because it is a tedious work to figure out and fix all errors request by request.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP status code</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">400 (BAD REQUEST)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">urn:problem:ValidationError</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">title</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Request validation failed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">details</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If not in a separate field, also in the details all Validation errors could be listed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">instance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A unique identifier to later correspond to the logs, to identify real problems with login.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">validationError</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A list of all errors that occurred during the validation.
The list should contain the fieldname and the reason of each failure</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_business_exceptions"><a class="anchor" href="#_business_exceptions"></a>Business Exceptions</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP status code</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Depending on the reason of the exception. Default: 400 (BAD REQUEST)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An exception specific type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">title</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exception specific title</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">details</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is often the message of the underlying exception.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">instance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A unique identifier to later correspond to the logs, to identify real problems with login.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_technical_exceptions"><a class="anchor" href="#_technical_exceptions"></a>Technical Exceptions</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP status code</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500 (INTERNAL_SERVER_ERROR) For technical exceptions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">An exception specific type. 'urn:problem:InternalServerError' could be the default.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">title</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exception specific title. 'An internal server error occurred' could be the default.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">details</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hide the concrete error details and display "An unexpected error has occurred! We apologize any inconvenience. Please try again later."</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">instance</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<hr>
<div id="giscus-div">
  <script src="https://giscus.app/client.js"
          data-repo="devonfw/java"
          data-repo-id="R_kgDOISza8Q"
          data-category="Feedback"
          data-category-id="DIC_kwDOISza8c4CSzPy"
          data-mapping="og:title"
          data-strict="0"
          data-reactions-enabled="1"
          data-emit-metadata="0"
          data-input-position="bottom"
          data-theme="light"
          data-lang="en"
          crossorigin="anonymous"
          async>
  </script>
<div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <div class="bottom-footer">
    <ul>
      <li><a href="https://devonfw.com/website/pages/docs/devonfw-guide_ide.wiki_LICENSE.asciidoc.html">Terms of use</a></li>
    </ul>
  </div>
</footer>
<script src="https://cginternal.devonfw.com/communitycontent/main.js"></script>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>
